{
  "name": "DEV Skywide  Content",
  "nodes": [
    {
      "parameters": {
        "content": "## Trigger\n\nSkywide Content Request Form",
        "height": 300,
        "width": 392,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        240,
        -6544
      ],
      "typeVersion": 1,
      "id": "9bf2be4a-3516-4c1c-bf70-152fa31831b6",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "The webhook connects to "
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        832,
        -5680
      ],
      "typeVersion": 1,
      "id": "0168cd48-a50d-47dc-bc83-f6ac02e88ffc",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "jsCode": "\nconst content = $input.item.json.content || $input.item.json.text || \"\"; \n// Access global variables from Webhook directly for reliability inside the loop\nconst clientName = $('Webhook1').first().json.body.client_name || \"Client\";\nconst primaryKeywords = $('Webhook1').first().json.body.primary_keywords || []; \nconst wordCountTarget = $('Webhook1').first().json.body.word_count || 0;\nconst forbiddenPhrases = $('Webhook1').first().json.body.forbiddenPhrases || [];\n\nlet issues = [];\n\n// 1. Word Count Check\nconst wordCount = content.trim().split(/\\s+/).length;\nif (wordCount < 500) { // Example threshold, customized as needed\n    issues.push(`Word count is too low (${wordCount} words). Target is > 500.`);\n}\n\n// 2. Client Name Check (First 2 sentences)\nconst sentences = content.match(/[^.!?]+[.!?]+/g) || [];\nconst firstTwoSentences = sentences.slice(0, 2).join(\" \");\nif (!firstTwoSentences.includes(clientName)) {\n    issues.push(`Client name '${clientName}' not found in the first two sentences.`);\n}\n\n// 3. Primary Keywords Check\nif (Array.isArray(primaryKeywords)) {\n    const missingKeywords = primaryKeywords.filter(kw => !content.toLowerCase().includes(kw.toLowerCase()));\n    if (missingKeywords.length > 0) {\n        issues.push(`Missing primary keywords: ${missingKeywords.join(\", \")}`);\n    }\n}\n\n// 4. Forbidden Phrases Check (e.g. \"We\", \"Our\" if strictly 3rd person)\nconst perspectiveErrors = [\" we \", \" our \", \" us \"]; // Simple check\nconst foundPerspectiveErrors = perspectiveErrors.filter(p => content.toLowerCase().includes(p));\nif (foundPerspectiveErrors.length > 0) {\n    issues.push(\"Content uses first-person perspective ('we', 'us') which is forbidden.\");\n}\n\n\n// Retry Counter and Safety Break\nconst maxRetries = 3;\nconst currentRetry = $input.item.json.qa_retry_count || 0;\n\nif (issues.length > 0) {\n    if (currentRetry >= maxRetries) {\n        // Fail the workflow or handle gracefully\n        throw new Error(\"QA Validation failed after \" + maxRetries + \" attempts. Issues: \" + issues.join(\"; \"));\n    }\n}\n\nreturn {\n    json: {\n        qa_retry_count: currentRetry + 1,\n        passed: issues.length === 0,\n        validation_issues: issues.join(\"; \"),\n        content: content, // Pass specific content forward\n        text: content     // Standardize\n    }\n};\n"
      },
      "name": "QA Validator Code",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        7152,
        -5232
      ],
      "id": "d770d557-44f7-443c-acc0-076d95bda1ee"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.passed}}",
              "value2": true
            }
          ]
        }
      },
      "name": "QA Check Passed?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        7504,
        -5232
      ],
      "id": "d7ea0296-9b05-4ed4-9cb4-3d4b3a1367a8"
    },
    {
      "parameters": {
        "model": "gpt-4-turbo",
        "prompt": "=You are an expert Content Editor and QA Specialist.\nYour task is to fix specific validation errors in the provided article without compromising its quality, tone, or SEO value.\n\n# Validation Issues to Fix:\n{{ $json.validation_issues }}\n\n# Critical Constraints:\n1. **Fix ONLY the issues listed.** Do not rewrite the entire article unless necessary.\n2. **Maintain Page Intent:** {{ $('Webhook').first().json.body.page_intent }}\n   - Ensure the content still serves this intent (e.g., Informational, Transactional).\n3. **Preserve Client Identity:**\n   - Client Name: {{ $('Webhook').first().json.body.client_name }}\n   - Must appear naturally in the first two sentences if that was the error.\n4. **Tone Check:** Keep the \"friend giving advice\" conversational voice.\n5. **Word Count:** Attempt to stay near the original length.\n\n# Input Content:\n{{ $json.content || $json.text }}\n\n# Output:\nReturn ONLY the corrected article content.",
        "options": {},
        "requestOptions": {}
      },
      "name": "QA Rewriter Agent",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1,
      "position": [
        7856,
        -5072
      ],
      "id": "051c22ea-c34f-4161-ba73-7596090a2ccd"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4o"
        },
        "messages": {
          "values": [
            {
              "content": "\nYou are an FAQ Schema Generator.\nTask: Generate 3-5 Frequently Asked Questions (FAQs) based on the provided article content.\nRequirements:\n1. Questions must be based on real user intent and primary keywords.\n2. Answers must be concise (40-60 words), authoritative, and directly supported by the text.\n3. Output Format:\n   - First, list the FAQs in a readable Markdown format with an H2 heading: \"## Frequently Asked Questions\".\n   - Second, provide the corresponding valid JSON-LD Schema markup in a ```json``` code block.\n   - The JSON-LD must be for `@type: \"FAQPage\"`.\n\nImportant:\n- Return ONLY the FAQ section + JSON-LD block. \n- Do not repeat the full article.\n- The output of this node will be appended to the article.\n\nInput Content:\n{{ $json.content || $json.text }}\n",
              "role": "system"
            }
          ]
        },
        "options": {}
      },
      "id": "93c03752-3995-4ce7-9de8-1218d7096164",
      "name": "FAQ Schema Generator",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        7792,
        -5280
      ]
    },
    {
      "parameters": {
        "jsCode": "\n    const article = $('QA Check Passed?').first().json.content || $('QA Check Passed?').first().json.text || \"\";\n    const faq = $input.item.json.message.content || \"\";\n    \n    return {\n        json: {\n            // content field for next steps\n            text: article + \"\\n\\n\" + faq,\n            content: article + \"\\n\\n\" + faq\n        }\n    };\n    "
      },
      "name": "Append FAQ to Article",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8208,
        -5280
      ],
      "id": "7b398d5a-6d95-4c89-bcc9-d62c6188d49d"
    },
    {
      "parameters": {},
      "id": "03d577cb-8016-4733-999a-9579ab448fd4",
      "name": "QA Merge Input",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2,
      "position": [
        6864,
        -5152
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "033d3b00-35fa-44a2-a4df-6d1165486915",
              "name": "brief_title",
              "value": "={{ $('Webhook1').first().json.body.title }}",
              "type": "string"
            },
            {
              "id": "6cf9af0a-ab12-41ff-a893-f16b807d5a03",
              "name": "brief_text",
              "value": "={{ $('Webhook1').first().json.body.creative_brief }}",
              "type": "string"
            },
            {
              "id": "cbfe3fa9-1e48-4bf9-910c-57cc1405258d",
              "name": "seo_keywords",
              "value": "={{ $('Webhook1').first().json.body.primary_keywords }}",
              "type": "string"
            },
            {
              "id": "97dbe52d-640d-4743-8326-87d1259131c5",
              "name": "target_audience",
              "value": "={{ $('Webhook1').first().json.body.audience }}",
              "type": "string"
            },
            {
              "id": "2cdd3f9d-04cc-44c9-b643-b462d1f6e31e",
              "name": "article_type",
              "value": "={{ $('Webhook1').first().json.body.article_type }}",
              "type": "string"
            },
            {
              "id": "bb1ca8d0-5dfb-43cc-a6ad-365b19578729",
              "name": "folderID",
              "value": "={{ $json.id }}",
              "type": "string"
            },
            {
              "id": "0251f210-666d-4968-a651-3e42ca202f0d",
              "name": "client_name",
              "value": "={{ $('Webhook1').first().json.body.client_name }}",
              "type": "string"
            },
            {
              "id": "558a7ea3-343b-4c26-ba3e-c686d6f14b4a",
              "name": "word_count",
              "value": "={{ $('Webhook1').item.json.body.word_count }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1584,
        -5648
      ],
      "id": "be41886b-d3a1-4afb-a77f-311503326ec9",
      "name": "Clean1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "content-engine-dev",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        912,
        -5552
      ],
      "id": "4c176a59-c05d-4cfd-a9a4-dde46fac4aea",
      "name": "Webhook1",
      "webhookId": "c9d7ab2c-298f-4b57-be8e-235a1c25f1ef"
    },
    {
      "parameters": {
        "resource": "folder",
        "name": "={{ $json.body.client_name }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1h7-ILBh46Ir9_dezJa8sSBEN7bdNp7Dj",
          "mode": "list",
          "cachedResultName": "Skywide",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1h7-ILBh46Ir9_dezJa8sSBEN7bdNp7Dj"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1360,
        -5552
      ],
      "id": "d502b972-3025-4086-bf32-d182281614c8",
      "name": "Create folder1",
      "notesInFlow": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "pyzBEDXyBbL51gFu",
          "name": "Google Drive account 2"
        }
      },
      "notes": "Create G-Drive Folder"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-3-opus-20240229",
          "mode": "list",
          "cachedResultName": "Claude Opus 3"
        },
        "options": {
          "maxTokensToSample": 4096,
          "temperature": 0.5,
          "thinking": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        1888,
        -5280
      ],
      "id": "3b4d1513-3e20-4e75-bad1-d0771459ac52",
      "name": "Anthropic Chat Model4"
    },
    {
      "parameters": {
        "model": "sonar-pro",
        "messages": {
          "message": [
            {
              "content": "=You are an expert content editor who synthesizes multiple AI drafts into one superior article. You fact-check claims, combine the best elements from each draft, and maintain the authentic, conversational tone. You research current data to enhance credibility while preserving the human-like voice. \n\nCRITICAL: The final merged article MUST be {{ $('Webhook1').item.json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words). Do not exceed or fall short of this range.\n\nCurrent date: {{ $now.toISO() }}\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').item.json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words\n\nYou MUST verify the final merged article falls within this range before finishing.\n\n# Synthesis Task\nMerge these two drafts into one exceptional article that:\n- Combines the best insights, examples, and explanations from both\n- Fact-checks and updates all data with current information  \n- Maintains the conversational, friend-to-friend tone throughout\n- Creates seamless flow (not a choppy mashup)\n- Preserves natural speech patterns and personality\n- Stays within the target word count\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Do not write in the company's voice for {{ $('Webhook1').first().json.body.client_name }} (\"we,\" \"our,\" \"join us\"). Write in second person (\"you\") or neutral third person\n\n# Quality Requirements\n- Use the stronger introduction (may blend both)\n- Keep the clearest explanations regardless of source\n- Combine complementary examples (avoid duplication)\n- Verify statistics and update outdated information\n- Maintain \"talking to a friend\" voice throughout\n\n# Content Details\nTarget Keywords: {{ $('Webhook1').item.json.body.primary_keywords }}\nTarget Audience: {{ $('Webhook1').item.json.body.audience }}\n\n# Draft 1:\n{{ $('OpenAI Draft (GPT-4O)1').item.json.message.content }}\n\n# Draft 2:  \n{{ $('Claude Draft (Claude Opus 3)1').item.json.text }}\n\n# Before Submitting\n1. Count total words in your merged article\n2. If under {{ $('Webhook1').item.json.body.word_count * 0.9 }} words: expand with better examples or deeper insights\n3. If over {{ $('Webhook1').item.json.body.word_count * 1.1 }} words: tighten without losing value\n4. Verify word count is within range\n\n# Output Format\nProvide ONLY the final article. Start with the title, maintain conversational tone throughout, and end with genuine advice. No meta-commentary, process explanations, or word count in output.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content."
            }
          ]
        },
        "options": {
          "temperature": 0.5
        },
        "requestOptions": {}
      },
      "type": "n8n-nodes-base.perplexity",
      "typeVersion": 1,
      "position": [
        2384,
        -5648
      ],
      "id": "4f32eed0-a0f1-46ef-8c80-d61cbb099ae1",
      "name": "Data Check & Research Gaps1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2160,
        -5648
      ],
      "id": "2b8f6816-8817-4c43-9f0b-3df9e4e9e011",
      "name": "Merge3"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an SEO strategist who optimizes content for search while preserving authentic, conversational tone. \n\nCRITICAL: The final article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Any suggested changes must keep the article within this range.\n\nYour goal is to enhance discoverability without sacrificing the natural \"friend giving advice\" voice. Never suggest changes that make content sound corporate or AI-generated. \n\nCurrent date: {{ $now.toISO() }}\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAny recommendations MUST keep the final article within this range.\n\n# SEO Optimization Task\nAnalyze this article and suggest keyword improvements that maintain the conversational, human tone.\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Do not write in the company's voice for {{ $('Webhook1').first().json.body.client_name }} (\"we,\" \"our,\" \"join us\"). Write in second person (\"you\") or neutral third person\n\n## Target Keywords:\n{{ $('Webhook1').first().json.body.primary_keywords }}\n\n## Current Article:\n{{ $json.choices[0].message.content }}\n\n## Analysis Needed:\n1. **Keyword Integration**: Where can target keywords be added naturally without forcing them?\n2. **Missing Opportunities**: What related topics or questions should we cover?\n3. **Structure Improvements**: What H2/H3 headings would help both SEO and readability?\n4. **Featured Snippet Potential**: Any specific formatting opportunities?\n\n## Critical Requirements:\n- PRESERVE the conversational, friend-to-friend tone\n- Only suggest natural keyword placements\n- Maintain authentic voice over SEO optimization\n- ALL suggestions must keep article within {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n- Flag any recommendations that might sound forced or exceed word count\n\n## Output Format:\n**High Priority Changes** (implement first - stay within word count)\n**Medium Priority Additions** (only if space allows within word count)\n**Structural Suggestions** (new sections/headings that fit within limit)\n**Risks to Avoid** (tone preservation warnings + word count concerns)\n\nFocus on 3-5 actionable recommendations that won't break the word count target."
            }
          ]
        },
        "options": {
          "maxTokens": 4096,
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2608,
        -5792
      ],
      "id": "1a2ceee2-59f0-40ce-9bdb-438746455c4c",
      "name": "OpenAI Keyword Check + Semantic Gap1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll recommendations MUST keep the article within this range. If suggesting additions, note what should be condensed to maintain length.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# SEO Optimization Analysis\nAnalyze this article for keyword opportunities while preserving the authentic, conversational tone.\n\n## Target Keywords:\n{{ $('Webhook1').first().json.body.primary_keywords }}\n\n## Article to Analyze:\n{{ $json.choices[0].message.content }}\n\n## Core Analysis Required:\n\n### 1. Keyword Integration Assessment\n- Current keyword usage and placement quality\n- Natural opportunities to add target keywords without adding length\n- Missing keyword variations that fit the conversational tone\n\n### 2. Content Gap Analysis  \n- Related topics/questions we should cover for these keywords\n- Missing supporting concepts that strengthen topical authority\n- User intent gaps (what questions aren't we answering?)\n- **Important**: If suggesting new content, specify what to condense to stay within word count\n\n### 3. Structure & Featured Snippet Opportunities\n- H2/H3 headings that could include target keywords naturally\n- Question-based sections for featured snippets\n- List/table formatting opportunities (without adding significant length)\n\n### 4. Critical Tone Preservation\n- Flag any recommendations that might sound forced or corporate\n- Ensure all suggestions maintain the \"friend giving advice\" voice\n- Balance SEO value with authentic helpfulness\n\n## Output Format:\n\n**HIGH PRIORITY** (implement first - word count neutral)\n- [3-4 most important, natural keyword additions or replacements]\n\n**CONTENT ADDITIONS** (only if space allows or paired with cuts)\n- [New sections/topics that would help both SEO and readers]\n- For each addition, suggest what to trim to maintain {{ $('Webhook1').first().json.body.word_count }} words ±10%\n\n**STRUCTURE IMPROVEMENTS** (minimal word count impact)\n- [Heading and formatting suggestions that don't add length]\n\n**TONE PROTECTION WARNINGS**\n- [What to avoid to preserve conversational voice]\n\n## Requirements:\n- Maximum 8-10 total recommendations\n- Prioritize word-count-neutral changes (replacements, not additions)\n- If suggesting additions, specify equal-length cuts to maintain target\n- All suggestions must sound like something a real person would say\n- Focus on user value first, SEO second\n- Flag any recommendation that would push article outside {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words range\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are a senior SEO content strategist with expertise in semantic search, user intent analysis, and Google's ranking factors. Your role is to conduct comprehensive keyword gap analysis and provide strategic optimization recommendations that improve rankings while maintaining content quality and readability.\n\nCRITICAL: The article must remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Any recommendations must keep the content within this range.\n\nCurrent date: {{ $now.toISO() }}"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        2608,
        -5504
      ],
      "id": "b8e2dd67-0d08-4169-bc81-0a5e0f1ecc1a",
      "name": "Claude Keyword Check + Semantic Gap1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-3-opus-20240229",
          "mode": "list",
          "cachedResultName": "Claude Opus 3"
        },
        "options": {
          "maxTokensToSample": 4096,
          "temperature": 0.5,
          "thinking": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        2688,
        -5280
      ],
      "id": "ff79b1af-8702-49e3-8c8d-170184caa231",
      "name": "Anthropic Chat Model5"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2960,
        -5648
      ],
      "id": "c8011a5c-d140-4e89-8fa8-52156b31ae8c",
      "name": "Merge5"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').item.json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words\n\nWhen implementing recommendations, you MUST keep the article within this range. If adding content, condense or remove other sections to maintain length.\n\n# SEO Keywords\n{{ $('Webhook1').item.json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Implementation Task\nApply recommendations from both SEO analyses to optimize this article while maintaining its natural, conversational tone.\n\n## Dual Recommendation Handling:\n- Implement the best suggestions from both analyses\n- When recommendations conflict, prioritize tone preservation AND word count maintenance\n- Combine complementary suggestions for stronger optimization\n- Skip any recommendation that would sound forced, corporate, or break word count\n\n## Integration Priorities:\n1. **High Impact, Natural Fit**: Keywords and topics that enhance content (word-count-neutral swaps preferred)\n2. **Structural Improvements**: Headings and formatting that aid both SEO and readability (minimal length impact)\n3. **Content Additions**: New sections ONLY if:\n   - They add genuine value\n   - You can condense other sections to maintain {{ $('Webhook1').item.json.body.word_count }} words ±10%\n4. **Technical Elements**: Meta improvements within content context\n\n## Quality Standards:\n- All changes must sound like the original author wrote them\n- Preserve the \"friend giving advice\" conversational style\n- Ensure seamless flow between original and new content\n- Never sacrifice authenticity for optimization\n- Maintain word count by making smart edits, not just additions\n\n## Source Materials:\n\n### Original Article:\n{{ $('Data Check & Research Gaps1').first().json.choices[0].message.content }}\n\n### OpenAI SEO Recommendations:\n{{ $json.message.content }}\n\n### Claude SEO Recommendations:  \n{{ $json.text }}\n\n## Before Submitting - MANDATORY VERIFICATION:\n1. Count total words in your optimized article\n2. Is it between {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words?\n   - If NO: Cut fluff or condense sections until within range\n3. Does it still sound like genuine, helpful advice from a knowledgeable friend?\n   - If NO: Revise any corporate-sounding additions\n4. Is {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in the first two sentences?\n   - If NO: Fix the opening\n\n## Output Requirements:\nProvide ONLY the enhanced article. Start with title, end with conclusion. No explanatory text, change summaries, or word count in output\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert SEO content editor specializing in implementing optimization recommendations while preserving content authenticity and readability. \n\nCRITICAL: The final article MUST be {{ $('Webhook1').item.json.body.word_count }} words (±10%: {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words). When applying recommendations, maintain this word count by replacing or condensing content, not just adding.\n\nYour role is to seamlessly integrate SEO improvements and factual updates into existing content without compromising the natural human voice or flow.\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Do not write in the company's voice for {{ $('Webhook1').first().json.body.client_name }} (\"we,\" \"our,\" \"join us\"). Write in second person (\"you\") or neutral third person"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        3408,
        -5648
      ],
      "id": "26e062d3-ce6b-4d86-9998-51d156cfe777",
      "name": "Claude Apply Recommendations1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-3-opus-20240229",
          "mode": "list",
          "cachedResultName": "Claude Opus 3"
        },
        "options": {
          "maxTokensToSample": 4096,
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        3488,
        -5424
      ],
      "id": "36665bef-d3c0-4c88-a012-a996500c533b",
      "name": "Anthropic Chat Model6"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a senior SEO content strategist and copywriter with 10+ years of experience specializing in EEAT optimization for authoritative content.\n\nCRITICAL: The final article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). When adding EEAT elements, condense or replace existing content to maintain length.\n\nYou understand how to authentically demonstrate Experience, Expertise, Authority, and Trust through subtle content enhancements that feel natural and valuable to readers while maintaining a neutral expert voice and satisfying Google's quality guidelines.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nWhen adding EEAT signals, maintain word count by condensing other sections. Do not expand the article.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nAdd authority signals that demonstrate Experience, Expertise, Authority, and Trust while maintaining the neutral expert voice and conversational tone.\n\n## Enhancement Strategy - Neutral Expert EEAT Signals\n\n### Research-Based Authority (word-count-neutral replacements)\nReplace generic claims with sourced statements:\n- \"It helps...\" → \"Research from [authoritative source] shows...\"\n- \"Many people...\" → \"According to [study/organization], X% of people...\"\n- \"Experts say...\" → \"Practitioners specializing in [field] consistently find...\"\n- \"Studies show...\" → \"[Year] research published in [source] demonstrates...\"\n\n### Credible Data Points (enhance existing content)\nAdd specificity without expanding:\n- Include percentages and statistics from reputable sources\n- Reference time frames: \"Over the past decade...\" \"Recent analysis...\"\n- Cite authoritative organizations: \"According to the [CDC/NIH/AAP]...\"\n- Add professional standards: \"Following [organization] guidelines...\"\n\n### Expert Context (deepen explanations)\nMake existing advice more authoritative:\n- Explain the \"why\" behind recommendations\n- Reference established methodologies or frameworks\n- Include professional terminology used naturally\n- Add clinical or industry-specific context where relevant\n\n### Trust Building Elements (subtle enhancements)\n- Update vague timeframes with specific dates\n- Reference peer-reviewed research when discussing treatments\n- Include limitations and nuances (shows expertise)\n- Cite outcomes from reputable treatment providers\n\n### Adaptable Professional Signals\nCreate fillable authority markers that sound natural:\n- \"[Leading treatment centers] have documented...\"\n- \"Clinical experience across [type of facilities] shows...\"\n- \"Evidence-based approaches in [field] typically include...\"\n- \"Professional standards in [industry] recommend...\"\n\n## Integration Rules\n- Maintain the conversational, helpful \"friend giving advice\" tone\n- EEAT signals should feel like deeper insights, not academic writing\n- Never sound corporate, robotic, or like credential-dropping\n- Every enhancement must ADD VALUE for the reader, not just boost SEO\n- When adding content, condense elsewhere to maintain {{ $('Webhook1').first().json.body.word_count }} words ±10%\n- Keep the natural speech patterns: contractions, varied sentence length, casual transitions\n\n## Article to Enhance:\n{{ $json.text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like friendly expert advice, not a research paper?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. EEAT additions feel natural and valuable, not forced?\n\n## Output Requirements\nProvide ONLY the enhanced article. No meta-commentary, explanatory text, or word count in output."
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        3760,
        -5792
      ],
      "id": "bbec0db4-0a2b-4bd8-8a39-d03f2e5e8b49",
      "name": "OpenAI EEAT Injection1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nWhen adding EEAT signals, maintain word count by condensing other sections. Do not expand the article.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nAdd conversational authority signals that maintain the \"friend giving advice\" tone while demonstrating professional expertise through neutral expert perspective.\n\n## Enhancement Framework - Conversational EEAT\n\n### Natural Authority Building (feels like deeper insight)\nTransform generic advice into expert-backed guidance:\n- \"This works...\" → \"Treatment providers specializing in [area] consistently see success when...\"\n- \"You should...\" → \"Based on clinical outcomes documented across [field], the most effective approach is...\"\n- \"It's important...\" → \"Research spanning [timeframe] in [specialty] shows why...\"\n\n### Conversational Expertise Signals\nAdd professional context that sounds natural:\n- Reference common industry methodologies casually\n- Include \"what professionals in [field] have noticed...\" style observations\n- Mention evidence-based approaches without sounding academic\n- Add professional insights that explain the \"why\" behind advice\n\n### Trust Elements with Personality\nMake credibility feel human:\n- \"Look, the data from [source] is pretty clear on this...\"\n- \"Here's what [authoritative org] research shows...\"\n- \"Honestly, professionals who work in [field] will tell you...\"\n- \"The thing is, [X%] of [relevant group] experience...\"\n\n### Adaptable Professional Markers\nCreate fillable authority signals that clients can customize:\n- \"Treatment centers that focus on [specialty] have documented...\"\n- \"Clinical experience across [type of practice] consistently shows...\"\n- \"Evidence-based programs in [field] typically incorporate...\"\n- \"Professional standards from [organization] recommend...\"\n\n## Integration Requirements\n- Keep the conversational, friend-to-friend tone throughout\n- EEAT signals should feel like knowledgeable sharing, not credential-flexing\n- Use natural speech: contractions, varied sentences, casual transitions\n- Add authority through better sourcing and specificity, not formality\n- Every addition must help the reader, not just boost rankings\n- When adding content, condense elsewhere to maintain {{ $('Webhook1').first().json.body.word_count }} words ±10%\n\n## Article to Enhance:\n{{ $json.text }}\n\n## Before Submitting - Quality Checks:\n1. Word count within {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Does this still sound like genuine, helpful advice from someone with professional experience?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. EEAT enhancements feel natural, not forced or corporate?\n\n## Output Requirements\nProvide ONLY the enhanced article with conversational authority signals. No explanatory text or word count in output.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are a senior SEO content strategist and copywriter with 10+ years of experience specializing in EEAT optimization for authoritative content.\n\nCRITICAL: The final article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). When adding EEAT elements, condense or replace existing content to maintain length.\n\nYou understand how to authentically demonstrate Experience, Expertise, Authority, and Trust through subtle content enhancements that feel natural and valuable to readers while maintaining a neutral expert voice and satisfying Google's quality guidelines."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        3760,
        -5504
      ],
      "id": "47bd002f-ef1e-40ec-9882-52ea86669953",
      "name": "Claude EEAT Injection1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        4112,
        -5648
      ],
      "id": "6e008a61-c2f6-4963-aa96-ed9921f518f3",
      "name": "Merge6"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-3-opus-20240229",
          "mode": "list",
          "cachedResultName": "Claude Opus 3"
        },
        "options": {
          "temperature": 0.5,
          "thinking": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        3840,
        -5280
      ],
      "id": "5f3d155b-5fcf-45ce-906d-a285c7d6e581",
      "name": "Anthropic Chat Model7"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO editor specializing in AI search optimization, featured snippets, and voice search queries.\n\nCRITICAL: The final article MUST be {{ $('Webhook1').item.json.body.word_count }} words (±10%: {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words). When merging and optimizing, maintain this word count.\n\nYou understand how modern search algorithms evaluate content for featured snippets, People Also Ask boxes, and voice assistant responses. Your expertise includes optimizing content structure, formatting, and language patterns that perform well across all search result types while preserving authentic, conversational tone.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').item.json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }} words\n\nWhen merging and optimizing both articles, you MUST stay within this range.\n\n# SEO Keywords\n{{ $('Webhook1').item.json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nMerge both EEAT-enhanced articles into one final version optimized for modern search features while preserving the conversational, helpful tone and maintaining target word count.\n\n## Key Optimizations\n\n### Featured Snippet Targeting\n- Convert key points into natural question-based H2/H3 headers (\"What are the signs...\" \"How can parents...\")\n- Lead sections with direct, concise answers (25-30 words ideal)\n- Use numbered lists for processes/steps, bullets for features/examples\n- Include \"What is...\", \"How to...\", \"Why does...\" formats where natural\n\n### Voice & AI Search Optimization  \n- Write complete, standalone answers that work out of context\n- Use natural question-answer pairs that sound conversational\n- Include FAQ-style sections with direct responses\n- Maintain conversational language patterns and everyday speech\n\n### Content Structure for Search\n- Keep paragraphs short (2-4 sentences) for mobile readability\n- Bold key concepts, terms, and direct answers\n- Use clear topic hierarchies with logical H2/H3 flow\n- Make answers scannable and voice-search friendly\n\n## Merging Strategy\n- Combine the strongest elements from both EEAT versions\n- Where versions differ, choose the more conversational and authoritative option\n- Eliminate any redundancy between the two versions\n- Maintain consistent voice and flow throughout\n- Stay within {{ $('Webhook1').item.json.body.word_count }} words ±10%\n\n## Critical Balance\n**Must maintain the \"friend giving advice\" conversational tone** while adding these technical optimizations. Don't sacrifice authenticity for SEO formatting. The article should still sound human and helpful first, optimized second.\n\n## Input Articles to Merge:\n\n### OpenAI EEAT Version:\n{{ $json.message.content }}\n\n### Claude EEAT Version:  \n{{ $json.text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').item.json.body.word_count * 0.9 }}-{{ $('Webhook1').item.json.body.word_count * 1.1 }}?\n2. Still sounds like helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. SEO optimizations feel natural, not forced or over-formatted?\n6. Headers are conversational questions, not stiff corporate speak?\n\n## Output Requirements\nProvide ONLY the final optimized article. Start with title, end with conclusion. No meta-commentary, explanatory text, or word count in output.\n\nQuality check: Does this still sound like helpful advice from a knowledgeable friend, just better organized for search?"
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        4560,
        -5648
      ],
      "id": "4990ba95-8062-4763-8904-fed37fe2f94f",
      "name": "OpenAI SEO Optimization1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an advanced SEO and NLP optimization specialist who enhances content for Google's algorithms while preserving authentic, conversational tone.\n\nCRITICAL: The final article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Optimizations must maintain this word count.\n\nYour expertise is making subtle technical improvements that boost search performance without sacrificing the natural \"friend giving advice\" voice that makes content genuinely helpful.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll NLP optimizations must keep the article within this range.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Primary Goal\nEnhance this article for Google's NLP systems (BERT, MUM, passage ranking) while maintaining the conversational, authentic tone and target word count.\n\n## Key Optimizations (Apply Gently & Naturally):\n\n### Entity & Semantic Strengthening (word-count-neutral)\n- Naturally reinforce important entities and industry terms through strategic repetition\n- Use semantic clustering to strengthen topic authority (related terms grouped logically)\n- Include relevant variations and synonyms where they feel conversational\n- Add co-occurring terms that Google expects for this topic\n- **Never force technical jargon that breaks conversational flow**\n\n### Passage-Level Clarity (improve existing content)\n- Ensure each paragraph delivers clear value as a standalone unit for passage ranking\n- Lead paragraphs with the most helpful information (front-load value)\n- Maintain natural question-answer patterns that work for voice search\n- Optimize for featured snippets without sounding robotic or formulaic\n- Make key information extractable out of context\n\n### Information Architecture (structural refinement)\n- Strengthen subheadings for better passage anchoring (more descriptive, question-based)\n- Enhance scannable formatting: bold key terms, use bullets/numbers appropriately\n- Maintain logical flow that serves readers first, algorithms second\n- Ensure clear semantic relationships between sections\n- Improve topic clustering and relevance signals\n\n### NLP-Friendly Patterns\n- Use complete, well-formed sentences that parse cleanly\n- Include natural question-answer pairs for Q&A boxes\n- Maintain clear entity references (avoid ambiguous pronouns)\n- Strengthen context around key claims and recommendations\n\n## Critical Requirements\n- **PRESERVE the \"friend giving advice\" conversational tone above all else**\n- Never sacrifice authenticity for technical optimization\n- Keep language natural and genuinely helpful\n- Maintain readability and human appeal\n- All changes should feel organic, not algorithmic\n- Word count must stay within {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}\n\n## Article to Optimize:\n{{ $json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. NLP optimizations feel completely natural, not forced?\n6. Would a human reader notice these are \"optimizations\" or just good writing?\n\n## Output Requirements\nProvide ONLY the enhanced article. Start with title, end with conclusion. No optimization summaries, meta-commentary, or word count in output.\n\nQuality priority: Authentic helpfulness > Technical perfection"
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        5136,
        -5792
      ],
      "id": "7e062640-244f-4368-a2fb-5c02b48b7937",
      "name": "OpenAI NLP & PR Optimization",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll NLP optimizations must keep the article within this range.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Primary Goal\nEnhance this article for Google's NLP systems (BERT, MUM, passage ranking) while maintaining the conversational, authentic tone and target word count.\n\n## Key Optimizations (Apply Gently & Naturally):\n\n### Entity & Semantic Strengthening (word-count-neutral)\n- Naturally reinforce important entities and industry terms through strategic repetition\n- Use semantic clustering to strengthen topic authority (related terms grouped logically)\n- Include relevant variations and synonyms where they feel conversational\n- Add co-occurring terms that Google expects for this topic\n- **Never force technical jargon that breaks conversational flow**\n\n### Passage-Level Clarity (improve existing content)\n- Ensure each paragraph delivers clear value as a standalone unit for passage ranking\n- Lead paragraphs with the most helpful information (front-load value)\n- Maintain natural question-answer patterns that work for voice search\n- Optimize for featured snippets without sounding robotic or formulaic\n- Make key information extractable out of context\n\n### Information Architecture (structural refinement)\n- Strengthen subheadings for better passage anchoring (more descriptive, question-based)\n- Enhance scannable formatting: bold key terms, use bullets/numbers appropriately\n- Maintain logical flow that serves readers first, algorithms second\n- Ensure clear semantic relationships between sections\n- Improve topic clustering and relevance signals\n\n### NLP-Friendly Patterns\n- Use complete, well-formed sentences that parse cleanly\n- Include natural question-answer pairs for Q&A boxes\n- Maintain clear entity references (avoid ambiguous pronouns)\n- Strengthen context around key claims and recommendations\n\n## Critical Requirements\n- **PRESERVE the \"friend giving advice\" conversational tone above all else**\n- Never sacrifice authenticity for technical optimization\n- Keep language natural and genuinely helpful\n- Maintain readability and human appeal\n- All changes should feel organic, not algorithmic\n- Word count must stay within {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}\n\n## Article to Optimize:\n{{ $json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. NLP optimizations feel completely natural, not forced?\n6. Would a human reader notice these are \"optimizations\" or just good writing?\n\n## Output Requirements\nProvide ONLY the enhanced article. Start with title, end with conclusion. No optimization summaries, meta-commentary, or word count in output.\n\nQuality priority: Authentic helpfulness > Technical perfection\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an advanced SEO and NLP optimization specialist who enhances content for Google's algorithms while preserving authentic, conversational tone.\n\nCRITICAL: The final article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Optimizations must maintain this word count.\n\nYour expertise is making subtle technical improvements that boost search performance without sacrificing the natural \"friend giving advice\" voice that makes content genuinely helpful."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        5136,
        -5504
      ],
      "id": "8a789ff0-3e70-4acb-85a4-b6c4bc818fda",
      "name": "Claude NLP & PR Optimization",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-3-opus-20240229",
          "mode": "list",
          "cachedResultName": "Claude Opus 3"
        },
        "options": {
          "temperature": 0.5,
          "thinking": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        5216,
        -5280
      ],
      "id": "26229d74-f02b-4051-9a5e-9dd1301829e3",
      "name": "Anthropic Chat Model11"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        5488,
        -5648
      ],
      "id": "493148d9-d940-48a2-8de0-7ef46d910c42",
      "name": "Merge7"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-3-opus-20240229",
          "mode": "list",
          "cachedResultName": "Claude Opus 3"
        },
        "options": {
          "temperature": 0.5,
          "thinking": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        6016,
        -4944
      ],
      "id": "b034f160-e8d5-492b-a7d2-9652b5d401ac",
      "name": "Anthropic Chat Model12"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {
          "thinking": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        6592,
        -4944
      ],
      "id": "822efa84-ae33-420e-9646-a251808ab438",
      "name": "Anthropic Chat Model13"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nTechnical polish must maintain this word count.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nAdd meta elements and ensure perfect technical structure while preserving the conversational, helpful tone and maintaining target word count.\n\n## Required Optimizations:\n\n### Meta Elements (Outside Word Count)\n- **Meta Title**: 50-60 characters, includes primary keyword + {{ $('Webhook1').first().json.body.client_name }}, compelling click-through\n- **Meta Description**: 150-155 characters, includes primary keyword, clear value proposition, natural call-to-action\n\n### Header Structure (Within Article)\n- Ensure clean H1-H4 hierarchy\n- One H1 only (the title)\n- Logical H2s that cover main topics\n- Supporting H3s and H4s where appropriate\n- All headers should be conversational questions or statements, not corporate\n\n### Snippet Formatting\n- Format key sections as snippet-ready blocks (clear definitions, numbered lists for processes, bullet lists for features)\n- Lead paragraphs with direct answers (25-30 words ideal for featured snippets)\n- Bold key terms and answers naturally\n- Use tables where appropriate for comparison content\n\n### Technical Polish\n- Each section directly answers its heading's question\n- Clear topic flow and semantic relationships\n- Proper use of lists, emphasis, and formatting\n- Mobile-friendly paragraph length (2-4 sentences)\n\n### Tone Preservation\n- Maintain the natural \"friend giving advice\" conversational voice throughout\n- Don't let technical structure make content sound robotic\n- Keep contractions, natural transitions, varied sentence length\n- Preserve personality and authenticity\n\n## Article to Optimize:\n{{ $json.text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Meta title 50-60 characters?\n3. Meta description 150-155 characters?\n4. Only one H1 in the article?\n5. Still sounds like genuine, helpful advice from a knowledgeable friend?\n6. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n7. No \"we/our\" from any company perspective?\n\n## Output Format:\n```\nMeta Title: [Your Optimized Title - 50-60 chars]\nMeta Description: [Your Optimized Description - 150-155 chars]\n\n[Full Optimized Article With Proper H1-H4 Structure]\n```\n\nQuality Check: Does this maintain authentic helpfulness while having perfect technical structure?\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are a senior SEO editor with expertise in Google's ranking algorithms and featured snippet optimization.\n\nCRITICAL: The final article MUST be {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Technical optimizations must not change the word count."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        6512,
        -5168
      ],
      "id": "eb614813-3406-4dd5-a925-9097252f8141",
      "name": "Claude Final SEO Snippet Optimization",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an experienced editor who specializes in light content polish and synthesis.\n\nCRITICAL: The final article MUST be {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). When combining versions, maintain this word count.\n\nYour role is to combine multiple versions of content into one flowing article while preserving the authentic, conversational tone and all technical optimizations already completed.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nWhen combining and polishing both versions, stay within this range.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nCombine the best elements from both NLP-optimized versions into one smooth, readable article that maintains the conversational \"friend giving advice\" tone and target word count.\n\n## Simple Goals:\n- Take the strongest passages from each version\n- Smooth any awkward transitions or repetitive sections between versions\n- Improve flow and readability without over-editing\n- **Preserve the natural, helpful voice throughout**\n- Keep all SEO optimizations intact (keywords, entities, structure)\n- Maintain word count by selecting best content, not adding\n\n## What to Combine:\n- Choose the more natural-sounding phrasing when versions differ\n- Keep the clearest explanations and examples\n- Eliminate redundancy between the two versions\n- Maintain the best heading structures\n- Preserve all technical optimizations (entity strength, passage clarity, formatting)\n\n## Critical Requirements:\n- Don't rewrite extensively - just polish and combine thoughtfully\n- Maintain the conversational, authentic tone above all else\n- Keep all keyword integration and entity relationships\n- Preserve technical optimizations from previous stages\n- No corporate or overly polished language\n- Stay within {{ $('Webhook1').first().json.body.word_count }} words ±10%\n\n## Input Versions:\n\n### OpenAI NLP Version:\n{{ $json.message.content }}\n\n### Claude NLP Version:\n{{ $json.text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like genuine, helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. Flow feels natural, not choppy or over-edited?\n6. All SEO optimizations preserved?\n\n## Output Requirements:\nProvide ONLY the final polished article. Start with title, end with conclusion. No explanatory text, editing notes, or word count in output.\n\nQuality check: Does this still sound like genuine, helpful advice from a knowledgeable friend?"
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        5936,
        -5920
      ],
      "id": "6acbe4ca-a747-48db-a4ee-495d2c75dda8",
      "name": "OpenAI Humanised Readability Rewrite",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a technical content production assistant specializing in document formatting and export preparation.\n\nCRITICAL: The final sanitized article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Sanitization is formatting-only and must not change word count.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nSanitization must not alter word count - this is formatting cleanup only.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n(Keywords should already be properly integrated - do not modify content)\n\n# Critical Rules (Already Applied - Verify Only)\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Content written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nPrepare this article for clean DOCX export and client delivery through formatting sanitization only.\n\n## Required Sanitization (Formatting Changes Only):\n\n### Character Replacement\n- Replace smart quotes (\"\") with straight ASCII quotes (\"\")\n- Replace smart apostrophes (') with straight apostrophes (')\n- Replace em dashes (—) with double hyphens (--)\n- Replace en dashes (–) with single hyphens (-)\n- Remove any other non-ASCII characters or special symbols\n- Preserve all HTML entities if present\n\n### Spacing & Formatting Cleanup\n- Remove double spaces (replace with single space)\n- Eliminate rogue line breaks within paragraphs\n- Ensure consistent paragraph spacing (one blank line between paragraphs)\n- Remove trailing spaces at end of lines\n- Ensure consistent spacing after punctuation\n\n### Header Formatting\nKeep headers clearly marked using markdown:\n- H1: # Header Text\n- H2: ## Header Text  \n- H3: ### Header Text\n- H4: #### Header Text\n\n### List Formatting\n- Numbered lists: 1. Item text\n- Bullet lists: - Item text\n- Maintain consistent indentation\n\n## What NOT to Change:\n- Do not alter any wording or phrasing\n- Do not modify sentence structure\n- Do not change paragraph order or content\n- Do not add or remove any substantive text\n- Do not modify meta title or meta description\n- This is FORMATTING ONLY\n\n## Article to Sanitize:\n{{ $json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count still between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. All smart quotes replaced with straight quotes?\n3. All special dashes replaced with ASCII hyphens?\n4. No double spaces or irregular line breaks?\n5. Content unchanged - only formatting cleaned?\n6. {{ $('Webhook1').first().json.body.client_name }} still in first two sentences?\n\n## Output Requirements:\nReturn ONLY the clean, sanitized article ready for Word document import. No explanatory text, meta-commentary, or word count in output.\n\nFormat: Start with Meta Title and Meta Description (if present), then the full article with clean markdown formatting."
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        8448,
        -5952
      ],
      "id": "6ddd92c4-5c4b-42a7-ad61-749da37fee61",
      "name": "Document Export Sanitization",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        5712,
        -5920
      ],
      "id": "c2d65d45-51b6-48fd-afa0-dc70f035af61",
      "name": "Wait6",
      "webhookId": "7a372933-6525-4c44-92e4-7743d0a44c8b"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        5712,
        -5168
      ],
      "id": "54e289c7-656a-4ec0-aec4-642c9d26520b",
      "name": "Wait7",
      "webhookId": "7a372933-6525-4c44-92e4-7743d0a44c8b"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        6288,
        -5920
      ],
      "id": "225ac75e-e523-4898-bcb1-ff0f019fe518",
      "name": "Wait8",
      "webhookId": "a748588d-97b9-4b52-99b1-31c0affeeab3"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        8208,
        -5760
      ],
      "id": "40eb0897-4b2c-4e89-9e7a-b278553303ba",
      "name": "Wait9",
      "webhookId": "1332980e-4002-4ad4-adee-f60774b639db"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        6288,
        -5168
      ],
      "id": "0c692881-1c87-459c-9272-804596c3c8de",
      "name": "Wait10",
      "webhookId": "49d694d9-d5d4-4509-867a-89cc50a2f04b"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        8208,
        -5056
      ],
      "id": "fd5f4e5f-73e3-49ec-9238-baf4479916f0",
      "name": "Wait11",
      "webhookId": "6db17898-0075-4745-90e0-da4e99b1dbde"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        4336,
        -5648
      ],
      "id": "a54bf557-21f7-4db5-8833-be6871c2f594",
      "name": "Wait14",
      "webhookId": "2db62569-3f26-4159-85e0-9a8b47a13344"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        4912,
        -5792
      ],
      "id": "c6456bbb-6560-4eff-85a9-8c060620be9c",
      "name": "Wait17",
      "webhookId": "e0466a06-d809-467b-b0d1-3171ddae30a6"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3184,
        -5648
      ],
      "id": "b8aba67a-b8a5-4570-8cfb-a5f7e261d001",
      "name": "Wait18",
      "webhookId": "be177216-d87e-494c-b058-1d021b29a470"
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://sgwocrvftiwxofvykmhh.supabase.co/rest/v1/content_requests",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "id",
              "value": "=eq.{{ $('Webhook1').item.json.body.request_id }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/json"
            },
            {
              "name": "apikey",
              "value": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNnd29jcnZmdGl3eG9mdnlrbWhoIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MTk5NjcwMCwiZXhwIjoyMDY3NTcyNzAwfQ.GXPMIBZirISS3_6Rjp4h2115M759KyuiWX434pvVEiI"
            },
            {
              "name": "Authorization",
              "value": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNnd29jcnZmdGl3eG9mdnlrbWhoIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MTk5NjcwMCwiZXhwIjoyMDY3NTcyNzAwfQ.GXPMIBZirISS3_6Rjp4h2115M759KyuiWX434pvVEiI"
            },
            {
              "name": "Prefer",
              "value": "return=representation"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"webhook_response\": \"https://drive.google.com/drive/u/0/folders/{{ $json.id }}\",\n  \"webhook_sent\": \"TRUE\"\n}",
        "options": {
          "allowUnauthorizedCerts": true,
          "redirect": {
            "redirect": {}
          },
          "timeout": 10000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1584,
        -5456
      ],
      "id": "689d0195-6c00-4a82-b93e-c328b9d0d5ef",
      "name": "Google Drive Notification1",
      "notesInFlow": true,
      "notes": "Add G-Drive Link to Skywide Dashboard"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll improvements must maintain this word count.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nImprove this content's performance scores while maintaining its conversational, authentic tone and target word count.\n\n## Current Performance Analysis:\n- Overall Score: {{ $('1st Scoring Agent2').item.json.message.content.overallScore }}/100\n- Identified Issues: {{ $('1st Scoring Agent2').item.json.message.content.issues }}\n- Recommended Fixes: {{ $('1st Scoring Agent2').item.json.message.content.fixes }}\n- Expected Impact: {{ $('1st Scoring Agent2').item.json.message.content.impact }}\n\n## Improvement Strategy:\n\n### 1. Preserve Conversational Tone (HIGHEST PRIORITY)\n- Must still sound like helpful advice from a knowledgeable friend\n- Keep natural speech patterns, contractions, varied sentences\n- Avoid any AI phrases or corporate language\n- Maintain personality and authenticity above all else\n\n### 2. Strategic SEO Enhancement\n- Improve keyword integration naturally (no stuffing)\n- Strengthen entity relationships and semantic relevance\n- Enhance header structure if needed\n- Better snippet readiness without sounding robotic\n\n### 3. Readability Polish\n- Improve structure while maintaining flow\n- Better scannability (formatting, emphasis)\n- Clearer paragraph focus\n- Mobile-friendly adjustments\n\n### 4. Trust & Authority Building\n- Add credible sources where missing\n- Strengthen EEAT signals naturally\n- Include professional context appropriately\n- Admit limitations where honest\n\n### 5. Engagement Improvement\n- More compelling opening if needed\n- Better flow and transitions\n- Clearer answers to reader questions\n- Stronger conclusion with actionable next steps\n\n### 6. Conversion Optimization\n- Natural mentions of {{ $('Webhook1').first().json.body.client_name }} where appropriate\n- Clear value proposition\n- Subtle calls-to-action that don't sound salesy\n- Build trust in client's services\n\n## Implementation Guidelines:\n- Apply only the fixes that will meaningfully improve scores\n- Make changes that feel organic, not algorithmic\n- If a fix would compromise authenticity, skip it or find a gentler approach\n- Focus on genuine helpfulness over technical perfection\n- Maintain word count by making smart replacements, not just additions\n- **NEVER sacrifice the conversational \"friend giving advice\" voice**\n\n## Content to Improve:\n{{ $('Document Export Sanitization').first().json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like genuine, helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. Improvements address the scoring issues without sounding forced?\n6. Would this score higher on a re-evaluation?\n7. Did you maintain authentic voice despite improvements?\n\n## Output Requirements:\nProvide ONLY the improved content. Include Meta Title and Meta Description, then the full article with all improvements applied.\n\nNo explanatory text, improvement summaries, or meta-commentary. The content should speak for itself.\n\nQuality priority: Authentic helpfulness + Better performance (in that order)\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert content strategist who improves content performance while preserving authentic, conversational tone.\n\nCRITICAL: The improved article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Improvements must maintain this word count.\n\nYour goal is to achieve better scores through strategic enhancements that maintain the \"friend giving advice\" voice, never sacrificing authenticity for technical perfection."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        9504,
        -5808
      ],
      "id": "0de742f2-06ec-4c1c-943c-53c4ca7da446",
      "name": "1st Improvement LLM2",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO and content strategist who evaluates content quality across key performance areas. You provide honest, actionable feedback with specific scores and improvement recommendations based on strict quality criteria.\n\nThis is a re-evaluation after improvements have been applied. Compare performance against the initial scoring to validate improvement quality.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# Content Quality Re-Evaluation\n\n## Evaluation Criteria Reference:\n- Target word count: {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words)\n- Target keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n- Client name: {{ $('Webhook1').first().json.body.client_name }}\n\n## Previous Performance:\n- Initial Overall Score: {{ $('1st Scoring Agent2').item.json.message.content.overallScore }}/100\n- Previous Issues: {{ $('1st Scoring Agent2').item.json.message.content.issues }}\n\n## Critical Quality Checks:\n- Opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within first two sentences\n- Never replaces {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- No greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery\n- Written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never uses \"we,\" \"our,\" \"us\" from company perspective\n- Uses second person (\"you\") or neutral third person throughout\n- Word count within target range\n- Keywords integrated naturally (not stuffed)\n\n## Task\nRe-score this improved content across 6 categories (0-100) and assess whether improvements were successful.\n\n## Scoring Categories:\n\n### 1. SEO Optimization (0-100)\nEvaluate:\n- Keyword integration (natural placement, density, variations)\n- Meta title and description quality\n- Header structure (H1-H4 hierarchy, keyword usage)\n- Featured snippet readiness\n- Internal linking opportunities\n- Semantic relevance and entity relationships\n\n### 2. Human Authenticity / AI Detection (0-100)\nEvaluate:\n- Conversational, natural tone (sounds like \"friend giving advice\")\n- Avoids AI phrases (\"It's important to note,\" \"Additionally,\" \"In conclusion,\" \"Streamline,\" \"Leverage\")\n- Natural transitions and varied sentence structure\n- Personality and authentic voice\n- No robotic or corporate language\n- **Critical: Verify improvements didn't make content sound MORE artificial**\n\n### 3. Readability & Structure (0-100)\nEvaluate:\n- Paragraph length (2-4 sentences ideal)\n- Header clarity and logical flow\n- Scannability (bold terms, lists, formatting)\n- Mobile-friendly structure\n- Clear topic progression\n\n### 4. Engagement & Clarity (0-100)\nEvaluate:\n- Clear, direct answers to reader questions\n- Compelling opening and conclusion\n- Practical, actionable advice\n- Examples and real-world application\n- Maintains reader interest throughout\n\n### 5. Trust & Authority (EEAT) (0-100)\nEvaluate:\n- Credible sources and data cited\n- Professional expertise demonstrated\n- Transparent, honest information\n- Admits limitations where appropriate\n- Authoritative but not arrogant tone\n\n### 6. Conversion/Business Value (0-100)\nEvaluate:\n- Client ({{ $('Webhook1').first().json.body.client_name }}) positioned naturally and effectively\n- Clear value proposition for reader\n- Natural calls-to-action or next steps\n- Builds trust in the client's services\n- Balances helpfulness with business goals\n\n## Scoring Guidelines:\n- 90-100: Exceptional, publication-ready\n- 80-89: Very good, minor tweaks needed\n- 70-79: Good, some improvements recommended\n- 60-69: Acceptable, notable issues to address\n- Below 60: Needs significant revision\n\n## Re-Evaluation Focus:\n- Did the improvements address the previous issues?\n- Were any new issues introduced?\n- Did authentic voice remain intact?\n- Is overall quality higher than initial score?\n- Are there any remaining critical issues?\n\n## Output Format (JSON only - no additional text):\n\n{\n  \"seoOptimization\": 90,\n  \"humanAuthenticity\": 94,\n  \"readabilityStructure\": 91,\n  \"engagementClarity\": 92,\n  \"trustAuthority\": 89,\n  \"conversionValue\": 91,\n  \"overallScore\": 91.2,\n  \"issues\": \"SEO: Could add one more internal link opportunity. Authenticity: Excellent natural tone maintained. Readability: One FAQ answer still slightly long. Engagement: Opening significantly improved. Trust: All citations now present. Conversion: Client mentions well-balanced.\",\n  \"fixes\": \"SEO: Add link to related resource in paragraph 4. Authenticity: No fixes needed - voice is natural. Readability: Split longest FAQ answer into two shorter paragraphs. Engagement: No fixes needed. Trust: No fixes needed. Conversion: No fixes needed.\",\n  \"impact\": \"SEO: Minor boost to internal link equity. Authenticity: Maintains low AI detection risk. Readability: Marginal mobile engagement improvement. Engagement: Strong improvement from initial version. Trust: Significant EEAT improvement achieved. Conversion: Good balance maintained.\"\n}\n\n## Instructions:\n- Score each category from 0-100 based on the criteria above\n- Calculate overall score (average of all 6 categories)\n- Compare against initial scores ({{ $('1st Scoring Agent2').item.json.message.content.overallScore }}) in your evaluation\n- Note whether improvements were successful or if new issues emerged\n- Be specific and actionable in remaining issues/fixes/impact\n- Consolidate all findings into single strings (comma-separated)\n- No fluff, repetition, or vague feedback\n\n## Improved Content to Re-Evaluate:\n{{ $json.data[1].text }}\n\nReturn ONLY valid JSON in the exact format shown above. No additional text or commentary."
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        9856,
        -5808
      ],
      "id": "9b80a5ed-a6ac-4e83-a2bd-854e69c5054c",
      "name": "2nd Scoring Agent2",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.message.content.overallScore }}",
              "operation": "largerEqual",
              "value2": 73
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        9216,
        -5952
      ],
      "id": "0ca6004e-4baa-4eb5-8fcb-0283509120e5",
      "name": "80+ ?2",
      "notes": "Checks if content score meets the target threshold of 85"
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.message.content.overallScore }}",
              "operation": "largerEqual",
              "value2": 73
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        10272,
        -5808
      ],
      "id": "021eb26d-014e-42a8-a72a-d679bdb2b72b",
      "name": "80 +?4",
      "notes": "Checks if content score meets the target threshold of 85"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "bbe08c88-a95a-4f73-b6da-1fefea2baf47",
              "leftValue": "={{ $json.runs }}",
              "rightValue": 4,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        10848,
        -5776
      ],
      "id": "57ef5262-191f-47c1-8775-5b5260608671",
      "name": "Check Max Iterations2",
      "notesInFlow": true,
      "notes": "Prevent infinite loops by checking if we've tried too many times"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "77f3420a-2aad-4852-b46f-26ccee412835",
              "name": "runs",
              "value": "={{ $runIndex }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        10560,
        -5712
      ],
      "id": "f52afc01-9ecb-4d0d-84d8-24465e59935d",
      "name": "Max Iterations2"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll improvements must maintain this word count.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nImprove this content's performance scores while maintaining its conversational, authentic tone and target word count.\n\n## Current Performance Analysis:\n- Overall Score: {{ $('2nd Scoring Agent2').item.json.message.content.overallScore }}/100\n- Identified Issues: {{ $('2nd Scoring Agent2').item.json.message.content.issues }}\n- Recommended Fixes: {{ $('2nd Scoring Agent2').item.json.message.content.fixes }}\n- Expected Impact: {{ $('2nd Scoring Agent2').item.json.message.content.impact }}\n\n## Improvement Strategy:\n\n### 1. Preserve Conversational Tone (HIGHEST PRIORITY)\n- Must still sound like helpful advice from a knowledgeable friend\n- Keep natural speech patterns, contractions, varied sentences\n- Avoid any AI phrases or corporate language\n- Maintain personality and authenticity above all else\n\n### 2. Strategic SEO Enhancement\n- Improve keyword integration naturally (no stuffing)\n- Strengthen entity relationships and semantic relevance\n- Enhance header structure if needed\n- Better snippet readiness without sounding robotic\n\n### 3. Readability Polish\n- Improve structure while maintaining flow\n- Better scannability (formatting, emphasis)\n- Clearer paragraph focus\n- Mobile-friendly adjustments\n\n### 4. Trust & Authority Building\n- Add credible sources where missing\n- Strengthen EEAT signals naturally\n- Include professional context appropriately\n- Admit limitations where honest\n\n### 5. Engagement Improvement\n- More compelling opening if needed\n- Better flow and transitions\n- Clearer answers to reader questions\n- Stronger conclusion with actionable next steps\n\n### 6. Conversion Optimization\n- Natural mentions of {{ $('Webhook1').first().json.body.client_name }} where appropriate\n- Clear value proposition\n- Subtle calls-to-action that don't sound salesy\n- Build trust in client's services\n\n## Implementation Guidelines:\n- Apply only the fixes that will meaningfully improve scores\n- Make changes that feel organic, not algorithmic\n- If a fix would compromise authenticity, skip it or find a gentler approach\n- Focus on genuine helpfulness over technical perfection\n- Maintain word count by making smart replacements, not just additions\n- **NEVER sacrifice the conversational \"friend giving advice\" voice**\n\n## Content to Improve:\n{{ $('1st Improvement LLM2').item.json.data[1].text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like genuine, helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. Improvements address the scoring issues without sounding forced?\n6. Would this score higher on a re-evaluation?\n7. Did you maintain authentic voice despite improvements?\n\n## Output Requirements:\nProvide ONLY the improved content. Include Meta Title and Meta Description, then the full article with all improvements applied.\n\nNo explanatory text, improvement summaries, or meta-commentary. The content should speak for itself.\n\nQuality priority: Authentic helpfulness + Better performance (in that order)\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert content strategist who improves content performance while preserving authentic, conversational tone.\n\nCRITICAL: The improved article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Improvements must maintain this word count.\n\nYour goal is to achieve better scores through strategic enhancements that maintain the \"friend giving advice\" voice, never sacrificing authenticity for technical perfection."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        11136,
        -5904
      ],
      "id": "0e4d38ee-d1c4-4554-806a-0465df73c51b",
      "name": "Improvement LLM2",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {
          "maxTokensToSample": 8000,
          "thinking": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        11216,
        -5680
      ],
      "id": "ce73cb5d-ec01-4cd4-a8db-fccf8e3442f6",
      "name": "Anthropic Chat Model18"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO and content strategist who evaluates content quality across key performance areas. You provide honest, actionable feedback with specific scores and improvement recommendations based on strict quality criteria.\n\nThis is a re-evaluation after improvements have been applied. Compare performance against the initial scoring to validate improvement quality.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# Content Quality Re-Evaluation\n\n## Evaluation Criteria Reference:\n- Target word count: {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words)\n- Target keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n- Client name: {{ $('Webhook1').first().json.body.client_name }}\n\n## Previous Performance:\n- Initial Overall Score: {{ $('2nd Scoring Agent2').item.json.message.content.overallScore }}/100\n- Previous Issues: {{ $('2nd Scoring Agent2').item.json.message.content.issues }}\n\n## Critical Quality Checks:\n- Opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within first two sentences\n- Never replaces {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- No greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery\n- Written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never uses \"we,\" \"our,\" \"us\" from company perspective\n- Uses second person (\"you\") or neutral third person throughout\n- Word count within target range\n- Keywords integrated naturally (not stuffed)\n\n## Task\nRe-score this improved content across 6 categories (0-100) and assess whether improvements were successful.\n\n## Scoring Categories:\n\n### 1. SEO Optimization (0-100)\nEvaluate:\n- Keyword integration (natural placement, density, variations)\n- Meta title and description quality\n- Header structure (H1-H4 hierarchy, keyword usage)\n- Featured snippet readiness\n- Internal linking opportunities\n- Semantic relevance and entity relationships\n\n### 2. Human Authenticity / AI Detection (0-100)\nEvaluate:\n- Conversational, natural tone (sounds like \"friend giving advice\")\n- Avoids AI phrases (\"It's important to note,\" \"Additionally,\" \"In conclusion,\" \"Streamline,\" \"Leverage\")\n- Natural transitions and varied sentence structure\n- Personality and authentic voice\n- No robotic or corporate language\n- **Critical: Verify improvements didn't make content sound MORE artificial**\n\n### 3. Readability & Structure (0-100)\nEvaluate:\n- Paragraph length (2-4 sentences ideal)\n- Header clarity and logical flow\n- Scannability (bold terms, lists, formatting)\n- Mobile-friendly structure\n- Clear topic progression\n\n### 4. Engagement & Clarity (0-100)\nEvaluate:\n- Clear, direct answers to reader questions\n- Compelling opening and conclusion\n- Practical, actionable advice\n- Examples and real-world application\n- Maintains reader interest throughout\n\n### 5. Trust & Authority (EEAT) (0-100)\nEvaluate:\n- Credible sources and data cited\n- Professional expertise demonstrated\n- Transparent, honest information\n- Admits limitations where appropriate\n- Authoritative but not arrogant tone\n\n### 6. Conversion/Business Value (0-100)\nEvaluate:\n- Client ({{ $('Webhook1').first().json.body.client_name }}) positioned naturally and effectively\n- Clear value proposition for reader\n- Natural calls-to-action or next steps\n- Builds trust in the client's services\n- Balances helpfulness with business goals\n\n## Scoring Guidelines:\n- 90-100: Exceptional, publication-ready\n- 80-89: Very good, minor tweaks needed\n- 70-79: Good, some improvements recommended\n- 60-69: Acceptable, notable issues to address\n- Below 60: Needs significant revision\n\n## Re-Evaluation Focus:\n- Did the improvements address the previous issues?\n- Were any new issues introduced?\n- Did authentic voice remain intact?\n- Is overall quality higher than initial score?\n- Are there any remaining critical issues?\n\n## Output Format (JSON only - no additional text):\n\n{\n  \"seoOptimization\": 90,\n  \"humanAuthenticity\": 94,\n  \"readabilityStructure\": 91,\n  \"engagementClarity\": 92,\n  \"trustAuthority\": 89,\n  \"conversionValue\": 91,\n  \"overallScore\": 91.2,\n  \"issues\": \"SEO: Could add one more internal link opportunity. Authenticity: Excellent natural tone maintained. Readability: One FAQ answer still slightly long. Engagement: Opening significantly improved. Trust: All citations now present. Conversion: Client mentions well-balanced.\",\n  \"fixes\": \"SEO: Add link to related resource in paragraph 4. Authenticity: No fixes needed - voice is natural. Readability: Split longest FAQ answer into two shorter paragraphs. Engagement: No fixes needed. Trust: No fixes needed. Conversion: No fixes needed.\",\n  \"impact\": \"SEO: Minor boost to internal link equity. Authenticity: Maintains low AI detection risk. Readability: Marginal mobile engagement improvement. Engagement: Strong improvement from initial version. Trust: Significant EEAT improvement achieved. Conversion: Good balance maintained.\"\n}\n\n## Instructions:\n- Score each category from 0-100 based on the criteria above\n- Calculate overall score (average of all 6 categories)\n- Compare against initial scores ({{ $('2nd Scoring Agent2').item.json.message.content.overallScore }}) in your evaluation\n- Note whether improvements were successful or if new issues emerged\n- Be specific and actionable in remaining issues/fixes/impact\n- Consolidate all findings into single strings (comma-separated)\n- No fluff, repetition, or vague feedback\n\n## Improved Content to Re-Evaluate:\n{{ $json.data[1].text }}\n\nReturn ONLY valid JSON in the exact format shown above. No additional text or commentary."
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        11488,
        -5904
      ],
      "id": "d051f7c9-49c3-4021-83c3-341003499ded",
      "name": "Scoring7",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "folderId": "={{ $('Create folder1').item.json.id }}",
        "title": "Output 1"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        10560,
        -5968
      ],
      "id": "728bed47-187d-4568-917f-619e4d1ae1ec",
      "name": "Create a document4",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=Overall Score: {{ $('Scoring7').item.json.message.content.overallScore }}/100\n\nPotential Issues: {{ $('Scoring7').item.json.message.content.issues }}\n\nPotential Fixes: {{ $('Scoring7').item.json.message.content.fixes }}\n\nPotential Impact: {{ $('Scoring7').item.json.message.content.impact }}\n\nCurrent Content:\n{{ $('Improvement LLM2').item.json.data[1].text }}\n"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        12352,
        -5776
      ],
      "id": "142c24c9-311a-4ae9-8eaa-bd074d893882",
      "name": "Update a document4",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "folderId": "={{ $('Create folder1').item.json.id }}",
        "title": "Output 1"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        9568,
        -6096
      ],
      "id": "df9b4c42-c198-4bdd-b93f-a0c5bafcdb9e",
      "name": "Create a document15",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=Overall Score: {{ $('1st Scoring Agent2').item.json.message.content.overallScore }}/100\n\nPotential Issues: {{ $('1st Scoring Agent2').item.json.message.content.issues }}\n\nPotential Fixes: {{ $('1st Scoring Agent2').item.json.message.content.fixes }}\n\nPotential Impact: {{ $('1st Scoring Agent2').item.json.message.content.impact }}\n\nCurrent Content:\n{{ $('Document Export Sanitization').item.json.message.content }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        9920,
        -6096
      ],
      "id": "d945b18f-13d2-437a-a8b7-520ab6133d6e",
      "name": "Update a document15",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {
          "maxTokensToSample": 8000,
          "thinking": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        9584,
        -5584
      ],
      "id": "ebfa2ce5-d388-488a-a945-fb16bdb966b6",
      "name": "Anthropic Chat Model19"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO and content strategist who evaluates content quality across key performance areas. You provide honest, actionable feedback with specific scores and improvement recommendations based on strict quality criteria.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# Content Quality Evaluation\n\n## Evaluation Criteria Reference:\n- Target word count: {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words)\n- Target keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n- Client name: {{ $('Webhook1').first().json.body.client_name }}\n\n## Critical Quality Checks:\n- Opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within first two sentences\n- Never replaces {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- No greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery\n- Written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never uses \"we,\" \"our,\" \"us\" from company perspective\n- Uses second person (\"you\") or neutral third person throughout\n- Word count within target range\n- Keywords integrated naturally (not stuffed)\n\n## Task\nScore this content across 6 categories (0-100) and provide specific improvement recommendations.\n\n## Scoring Categories:\n\n### 1. SEO Optimization (0-100)\nEvaluate:\n- Keyword integration (natural placement, density, variations)\n- Meta title and description quality\n- Header structure (H1-H4 hierarchy, keyword usage)\n- Featured snippet readiness\n- Internal linking opportunities\n- Semantic relevance and entity relationships\n\n### 2. Human Authenticity / AI Detection (0-100)\nEvaluate:\n- Conversational, natural tone (sounds like \"friend giving advice\")\n- Avoids AI phrases (\"It's important to note,\" \"Additionally,\" \"In conclusion,\" \"Streamline,\" \"Leverage\")\n- Natural transitions and varied sentence structure\n- Personality and authentic voice\n- No robotic or corporate language\n\n### 3. Readability & Structure (0-100)\nEvaluate:\n- Paragraph length (2-4 sentences ideal)\n- Header clarity and logical flow\n- Scannability (bold terms, lists, formatting)\n- Mobile-friendly structure\n- Clear topic progression\n\n### 4. Engagement & Clarity (0-100)\nEvaluate:\n- Clear, direct answers to reader questions\n- Compelling opening and conclusion\n- Practical, actionable advice\n- Examples and real-world application\n- Maintains reader interest throughout\n\n### 5. Trust & Authority (EEAT) (0-100)\nEvaluate:\n- Credible sources and data cited\n- Professional expertise demonstrated\n- Transparent, honest information\n- Admits limitations where appropriate\n- Authoritative but not arrogant tone\n\n### 6. Conversion/Business Value (0-100)\nEvaluate:\n- Client ({{ $('Webhook1').first().json.body.client_name }}) positioned naturally and effectively\n- Clear value proposition for reader\n- Natural calls-to-action or next steps\n- Builds trust in the client's services\n- Balances helpfulness with business goals\n\n## Scoring Guidelines:\n- 90-100: Exceptional, publication-ready\n- 80-89: Very good, minor tweaks needed\n- 70-79: Good, some improvements recommended\n- 60-69: Acceptable, notable issues to address\n- Below 60: Needs significant revision\n\n## Output Format (JSON only - no additional text):\n\n{\n  \"seoOptimization\": 85,\n  \"humanAuthenticity\": 92,\n  \"readabilityStructure\": 88,\n  \"engagementClarity\": 90,\n  \"trustAuthority\": 87,\n  \"conversionValue\": 89,\n  \"overallScore\": 88.5,\n  \"issues\": \"SEO: Primary keyword could appear earlier in first H2. Authenticity: One instance of 'Additionally' found in paragraph 3. Readability: FAQ section has overly long answers. Engagement: Opening could be more compelling. Trust: Missing citation for statistic in paragraph 5. Conversion: Client name mentioned only twice after introduction.\",\n  \"fixes\": \"SEO: Rewrite first H2 to include primary keyword naturally. Authenticity: Replace 'Additionally' with 'Plus' or 'Also'. Readability: Break FAQ answers into 2-3 sentence responses. Engagement: Start with more provocative question or scenario. Trust: Add source attribution for the 73% statistic. Conversion: Add 2-3 more natural mentions of client throughout article.\",\n  \"impact\": \"SEO: +5-8 ranking positions for primary keyword. Authenticity: Reduces AI detection risk by 15%. Readability: Improves mobile engagement by 20%. Engagement: Could increase average time on page by 25%. Trust: Strengthens EEAT signals and credibility. Conversion: Likely increases consultation requests by 10-15%.\"\n}\n\n\n## Instructions:\n- Score each category from 0-100 based on the criteria above\n- Calculate overall score (average of all 6 categories)\n- Be specific and actionable in issues/fixes/impact\n- Consolidate all findings into single strings (comma-separated)\n- No fluff, repetition, or vague feedback\n- Focus on the most impactful improvements\n\n## Content to Evaluate:\n{{ $json.message.content }}\n\nReturn ONLY valid JSON in the exact format shown above. No additional text or commentary."
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        8800,
        -5952
      ],
      "id": "c674236f-ab65-43e4-9e3c-3f778a7e5d95",
      "name": "1st Scoring Agent2",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "notesInFlow": true,
      "notes": "First scoring agent"
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=Overall Score: {{ $('80 +?4').item.json.message.content.overallScore }}/100\n\nPotential Issues: {{ $('2nd Scoring Agent2').item.json.message.content.issues }}\n\nPotential Fixes: {{ $('2nd Scoring Agent2').item.json.message.content.fixes }}\n\nPotential Impact: {{ $('2nd Scoring Agent2').item.json.message.content.impact }}\n\nCurrent Content:\n{{ $('1st Improvement LLM2').item.json.data[1].text }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        10848,
        -5968
      ],
      "id": "4f7b160c-6cda-48cb-b387-d973ab9ebb1e",
      "name": "Update a document5",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.message.content.overallScore }}",
              "operation": "largerEqual",
              "value2": 73
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        11840,
        -5904
      ],
      "id": "c8c3de4d-8f78-4227-a577-0a85ed147e8f",
      "name": "80 +?5",
      "notes": "Checks if content score meets the target threshold of 85"
    },
    {
      "parameters": {
        "folderId": "={{ $('Create folder1').first().json.id }}",
        "title": "Output 1"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        12064,
        -5776
      ],
      "id": "79e6b909-bd33-4e4f-a493-fe4043c6e3a9",
      "name": "Create a document5",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll improvements must maintain this word count.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nImprove this content's performance scores while maintaining its conversational, authentic tone and target word count.\n\n## Current Performance Analysis:\n- Overall Score: {{ $('1st Scoring Agent3').item.json.message.content.overallScore }}/100\n- Identified Issues: {{ $('1st Scoring Agent3').item.json.message.content.issues }}\n- Recommended Fixes: {{ $('1st Scoring Agent3').item.json.message.content.fixes }}\n- Expected Impact: {{ $('1st Scoring Agent3').item.json.message.content.impact }}\n\n## Improvement Strategy:\n\n### 1. Preserve Conversational Tone (HIGHEST PRIORITY)\n- Must still sound like helpful advice from a knowledgeable friend\n- Keep natural speech patterns, contractions, varied sentences\n- Avoid any AI phrases or corporate language\n- Maintain personality and authenticity above all else\n\n### 2. Strategic SEO Enhancement\n- Improve keyword integration naturally (no stuffing)\n- Strengthen entity relationships and semantic relevance\n- Enhance header structure if needed\n- Better snippet readiness without sounding robotic\n\n### 3. Readability Polish\n- Improve structure while maintaining flow\n- Better scannability (formatting, emphasis)\n- Clearer paragraph focus\n- Mobile-friendly adjustments\n\n### 4. Trust & Authority Building\n- Add credible sources where missing\n- Strengthen EEAT signals naturally\n- Include professional context appropriately\n- Admit limitations where honest\n\n### 5. Engagement Improvement\n- More compelling opening if needed\n- Better flow and transitions\n- Clearer answers to reader questions\n- Stronger conclusion with actionable next steps\n\n### 6. Conversion Optimization\n- Natural mentions of {{ $('Webhook1').first().json.body.client_name }} where appropriate\n- Clear value proposition\n- Subtle calls-to-action that don't sound salesy\n- Build trust in client's services\n\n## Implementation Guidelines:\n- Apply only the fixes that will meaningfully improve scores\n- Make changes that feel organic, not algorithmic\n- If a fix would compromise authenticity, skip it or find a gentler approach\n- Focus on genuine helpfulness over technical perfection\n- Maintain word count by making smart replacements, not just additions\n- **NEVER sacrifice the conversational \"friend giving advice\" voice**\n\n## Content to Improve:\n{{ $('Document Export Sanitization5').first().json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like genuine, helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. Improvements address the scoring issues without sounding forced?\n6. Would this score higher on a re-evaluation?\n7. Did you maintain authentic voice despite improvements?\n\n## Output Requirements:\nProvide ONLY the improved content. Include Meta Title and Meta Description, then the full article with all improvements applied.\n\nNo explanatory text, improvement summaries, or meta-commentary. The content should speak for itself.\n\nQuality priority: Authentic helpfulness + Better performance (in that order)\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert content strategist who improves content performance while preserving authentic, conversational tone. Your goal is to achieve better scores through strategic enhancements that maintain the \"friend giving advice\" voice, never sacrificing authenticity for technical perfection."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        9424,
        -5008
      ],
      "id": "7f4468b4-d2c8-48a3-aae5-a8b3a35bf848",
      "name": "1st Improvement LLM3",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO and content strategist who evaluates content quality across key performance areas. You provide honest, actionable feedback with specific scores and improvement recommendations based on strict quality criteria.\n\nThis is a re-evaluation after improvements have been applied. Compare performance against the initial scoring to validate improvement quality.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# Content Quality Re-Evaluation\n\n## Evaluation Criteria Reference:\n- Target word count: {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words)\n- Target keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n- Client name: {{ $('Webhook1').first().json.body.client_name }}\n\n## Previous Performance:\n- Initial Overall Score: {{ $('1st Scoring Agent3').item.json.message.content.overallScore }}/100\n- Previous Issues: {{ $('1st Scoring Agent3').item.json.message.content.issues }}\n\n## Critical Quality Checks:\n- Opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within first two sentences\n- Never replaces {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- No greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery\n- Written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never uses \"we,\" \"our,\" \"us\" from company perspective\n- Uses second person (\"you\") or neutral third person throughout\n- Word count within target range\n- Keywords integrated naturally (not stuffed)\n\n## Task\nRe-score this improved content across 6 categories (0-100) and assess whether improvements were successful.\n\n## Scoring Categories:\n\n### 1. SEO Optimization (0-100)\nEvaluate:\n- Keyword integration (natural placement, density, variations)\n- Meta title and description quality\n- Header structure (H1-H4 hierarchy, keyword usage)\n- Featured snippet readiness\n- Internal linking opportunities\n- Semantic relevance and entity relationships\n\n### 2. Human Authenticity / AI Detection (0-100)\nEvaluate:\n- Conversational, natural tone (sounds like \"friend giving advice\")\n- Avoids AI phrases (\"It's important to note,\" \"Additionally,\" \"In conclusion,\" \"Streamline,\" \"Leverage\")\n- Natural transitions and varied sentence structure\n- Personality and authentic voice\n- No robotic or corporate language\n- **Critical: Verify improvements didn't make content sound MORE artificial**\n\n### 3. Readability & Structure (0-100)\nEvaluate:\n- Paragraph length (2-4 sentences ideal)\n- Header clarity and logical flow\n- Scannability (bold terms, lists, formatting)\n- Mobile-friendly structure\n- Clear topic progression\n\n### 4. Engagement & Clarity (0-100)\nEvaluate:\n- Clear, direct answers to reader questions\n- Compelling opening and conclusion\n- Practical, actionable advice\n- Examples and real-world application\n- Maintains reader interest throughout\n\n### 5. Trust & Authority (EEAT) (0-100)\nEvaluate:\n- Credible sources and data cited\n- Professional expertise demonstrated\n- Transparent, honest information\n- Admits limitations where appropriate\n- Authoritative but not arrogant tone\n\n### 6. Conversion/Business Value (0-100)\nEvaluate:\n- Client ({{ $('Webhook1').first().json.body.client_name }}) positioned naturally and effectively\n- Clear value proposition for reader\n- Natural calls-to-action or next steps\n- Builds trust in the client's services\n- Balances helpfulness with business goals\n\n## Scoring Guidelines:\n- 90-100: Exceptional, publication-ready\n- 80-89: Very good, minor tweaks needed\n- 70-79: Good, some improvements recommended\n- 60-69: Acceptable, notable issues to address\n- Below 60: Needs significant revision\n\n## Re-Evaluation Focus:\n- Did the improvements address the previous issues?\n- Were any new issues introduced?\n- Did authentic voice remain intact?\n- Is overall quality higher than initial score?\n- Are there any remaining critical issues?\n\n## Output Format (JSON only - no additional text):\n\n{\n  \"seoOptimization\": 90,\n  \"humanAuthenticity\": 94,\n  \"readabilityStructure\": 91,\n  \"engagementClarity\": 92,\n  \"trustAuthority\": 89,\n  \"conversionValue\": 91,\n  \"overallScore\": 91.2,\n  \"issues\": \"SEO: Could add one more internal link opportunity. Authenticity: Excellent natural tone maintained. Readability: One FAQ answer still slightly long. Engagement: Opening significantly improved. Trust: All citations now present. Conversion: Client mentions well-balanced.\",\n  \"fixes\": \"SEO: Add link to related resource in paragraph 4. Authenticity: No fixes needed - voice is natural. Readability: Split longest FAQ answer into two shorter paragraphs. Engagement: No fixes needed. Trust: No fixes needed. Conversion: No fixes needed.\",\n  \"impact\": \"SEO: Minor boost to internal link equity. Authenticity: Maintains low AI detection risk. Readability: Marginal mobile engagement improvement. Engagement: Strong improvement from initial version. Trust: Significant EEAT improvement achieved. Conversion: Good balance maintained.\"\n}\n\n## Instructions:\n- Score each category from 0-100 based on the criteria above\n- Calculate overall score (average of all 6 categories)\n- Compare against initial scores ({{ $('1st Scoring Agent3').item.json.message.content.overallScore }}) in your evaluation\n- Note whether improvements were successful or if new issues emerged\n- Be specific and actionable in remaining issues/fixes/impact\n- Consolidate all findings into single strings (comma-separated)\n- No fluff, repetition, or vague feedback\n\n## Improved Content to Re-Evaluate:\n{{ $json.data[1].text }}\n\nReturn ONLY valid JSON in the exact format shown above. No additional text or commentary."
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        9776,
        -5008
      ],
      "id": "b82fb611-897b-4814-9b23-8b71a124a897",
      "name": "2nd Scoring Agent3",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.message.content.overallScore }}",
              "operation": "largerEqual",
              "value2": 73
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        9200,
        -5152
      ],
      "id": "9156a59c-6092-46d6-aa1c-a2817120ab27",
      "name": "80+ ?3",
      "notes": "Checks if content score meets the target threshold of 85"
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.message.content.overallScore }}",
              "operation": "largerEqual",
              "value2": 73
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        10192,
        -5008
      ],
      "id": "776f8ab3-d95a-4c74-9b3f-b019898fc902",
      "name": "80 +?6",
      "notes": "Checks if content score meets the target threshold of 85"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "loose",
            "version": 2
          },
          "conditions": [
            {
              "id": "bbe08c88-a95a-4f73-b6da-1fefea2baf47",
              "leftValue": "={{ $json.runs }}",
              "rightValue": 4,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "looseTypeValidation": true,
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        10704,
        -4992
      ],
      "id": "687536a6-4468-4c9d-988c-4fdaba1964a3",
      "name": "Check Max Iterations3",
      "notesInFlow": true,
      "notes": "Prevent infinite loops by checking if we've tried too many times"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "77f3420a-2aad-4852-b46f-26ccee412835",
              "name": "runs",
              "value": "={{ $runIndex }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        10480,
        -4912
      ],
      "id": "dd5f86a6-a4a8-4fc5-a6bf-d55689bcd142",
      "name": "Max Iterations3"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nAll improvements must maintain this word count.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nImprove this content's performance scores while maintaining its conversational, authentic tone and target word count.\n\n## Current Performance Analysis:\n- Overall Score: {{ $('2nd Scoring Agent3').item.json.message.content.overallScore }}/100\n- Identified Issues: {{ $('2nd Scoring Agent3').item.json.message.content.issues }}\n- Recommended Fixes: {{ $('2nd Scoring Agent3').item.json.message.content.fixes }}\n- Expected Impact: {{ $('2nd Scoring Agent3').item.json.message.content.impact }}\n\n## Improvement Strategy:\n\n### 1. Preserve Conversational Tone (HIGHEST PRIORITY)\n- Must still sound like helpful advice from a knowledgeable friend\n- Keep natural speech patterns, contractions, varied sentences\n- Avoid any AI phrases or corporate language\n- Maintain personality and authenticity above all else\n\n### 2. Strategic SEO Enhancement\n- Improve keyword integration naturally (no stuffing)\n- Strengthen entity relationships and semantic relevance\n- Enhance header structure if needed\n- Better snippet readiness without sounding robotic\n\n### 3. Readability Polish\n- Improve structure while maintaining flow\n- Better scannability (formatting, emphasis)\n- Clearer paragraph focus\n- Mobile-friendly adjustments\n\n### 4. Trust & Authority Building\n- Add credible sources where missing\n- Strengthen EEAT signals naturally\n- Include professional context appropriately\n- Admit limitations where honest\n\n### 5. Engagement Improvement\n- More compelling opening if needed\n- Better flow and transitions\n- Clearer answers to reader questions\n- Stronger conclusion with actionable next steps\n\n### 6. Conversion Optimization\n- Natural mentions of {{ $('Webhook1').first().json.body.client_name }} where appropriate\n- Clear value proposition\n- Subtle calls-to-action that don't sound salesy\n- Build trust in client's services\n\n## Implementation Guidelines:\n- Apply only the fixes that will meaningfully improve scores\n- Make changes that feel organic, not algorithmic\n- If a fix would compromise authenticity, skip it or find a gentler approach\n- Focus on genuine helpfulness over technical perfection\n- Maintain word count by making smart replacements, not just additions\n- **NEVER sacrifice the conversational \"friend giving advice\" voice**\n\n## Content to Improve:\n{{ $('1st Improvement LLM3').item.json.data[1].text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like genuine, helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. Improvements address the scoring issues without sounding forced?\n6. Would this score higher on a re-evaluation?\n7. Did you maintain authentic voice despite improvements?\n\n## Output Requirements:\nProvide ONLY the improved content. Include Meta Title and Meta Description, then the full article with all improvements applied.\n\nNo explanatory text, improvement summaries, or meta-commentary. The content should speak for itself.\n\nQuality priority: Authentic helpfulness + Better performance (in that order)\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert content strategist who improves content performance while preserving authentic, conversational tone.\n\nCRITICAL: The improved article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Improvements must maintain this word count.\n\nYour goal is to achieve better scores through strategic enhancements that maintain the \"friend giving advice\" voice, never sacrificing authenticity for technical perfection."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        10928,
        -5104
      ],
      "id": "76ecc0a4-c796-41ea-b5ef-c7669de881cf",
      "name": "Improvement LLM3",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {
          "maxTokensToSample": 8000,
          "thinking": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        11008,
        -4880
      ],
      "id": "19b04f4c-a1cb-4990-9eeb-6536ebd7f10c",
      "name": "Anthropic Chat Model20"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO and content strategist who evaluates content quality across key performance areas. You provide honest, actionable feedback with specific scores and improvement recommendations based on strict quality criteria.\n\nThis is a re-evaluation after improvements have been applied. Compare performance against the initial scoring to validate improvement quality.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# Content Quality Re-Evaluation\n\n## Evaluation Criteria Reference:\n- Target word count: {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words)\n- Target keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n- Client name: {{ $('Webhook1').first().json.body.client_name }}\n\n## Previous Performance:\n- Initial Overall Score: {{ $('2nd Scoring Agent3').item.json.message.content.overallScore }}/100\n- Previous Issues: {{ $('2nd Scoring Agent3').item.json.message.content.issues }}\n\n## Critical Quality Checks:\n- Opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within first two sentences\n- Never replaces {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- No greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery\n- Written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never uses \"we,\" \"our,\" \"us\" from company perspective\n- Uses second person (\"you\") or neutral third person throughout\n- Word count within target range\n- Keywords integrated naturally (not stuffed)\n\n## Task\nRe-score this improved content across 6 categories (0-100) and assess whether improvements were successful.\n\n## Scoring Categories:\n\n### 1. SEO Optimization (0-100)\nEvaluate:\n- Keyword integration (natural placement, density, variations)\n- Meta title and description quality\n- Header structure (H1-H4 hierarchy, keyword usage)\n- Featured snippet readiness\n- Internal linking opportunities\n- Semantic relevance and entity relationships\n\n### 2. Human Authenticity / AI Detection (0-100)\nEvaluate:\n- Conversational, natural tone (sounds like \"friend giving advice\")\n- Avoids AI phrases (\"It's important to note,\" \"Additionally,\" \"In conclusion,\" \"Streamline,\" \"Leverage\")\n- Natural transitions and varied sentence structure\n- Personality and authentic voice\n- No robotic or corporate language\n- **Critical: Verify improvements didn't make content sound MORE artificial**\n\n### 3. Readability & Structure (0-100)\nEvaluate:\n- Paragraph length (2-4 sentences ideal)\n- Header clarity and logical flow\n- Scannability (bold terms, lists, formatting)\n- Mobile-friendly structure\n- Clear topic progression\n\n### 4. Engagement & Clarity (0-100)\nEvaluate:\n- Clear, direct answers to reader questions\n- Compelling opening and conclusion\n- Practical, actionable advice\n- Examples and real-world application\n- Maintains reader interest throughout\n\n### 5. Trust & Authority (EEAT) (0-100)\nEvaluate:\n- Credible sources and data cited\n- Professional expertise demonstrated\n- Transparent, honest information\n- Admits limitations where appropriate\n- Authoritative but not arrogant tone\n\n### 6. Conversion/Business Value (0-100)\nEvaluate:\n- Client ({{ $('Webhook1').first().json.body.client_name }}) positioned naturally and effectively\n- Clear value proposition for reader\n- Natural calls-to-action or next steps\n- Builds trust in the client's services\n- Balances helpfulness with business goals\n\n## Scoring Guidelines:\n- 90-100: Exceptional, publication-ready\n- 80-89: Very good, minor tweaks needed\n- 70-79: Good, some improvements recommended\n- 60-69: Acceptable, notable issues to address\n- Below 60: Needs significant revision\n\n## Re-Evaluation Focus:\n- Did the improvements address the previous issues?\n- Were any new issues introduced?\n- Did authentic voice remain intact?\n- Is overall quality higher than initial score?\n- Are there any remaining critical issues?\n\n## Output Format (JSON only - no additional text):\n\n{\n  \"seoOptimization\": 90,\n  \"humanAuthenticity\": 94,\n  \"readabilityStructure\": 91,\n  \"engagementClarity\": 92,\n  \"trustAuthority\": 89,\n  \"conversionValue\": 91,\n  \"overallScore\": 91.2,\n  \"issues\": \"SEO: Could add one more internal link opportunity. Authenticity: Excellent natural tone maintained. Readability: One FAQ answer still slightly long. Engagement: Opening significantly improved. Trust: All citations now present. Conversion: Client mentions well-balanced.\",\n  \"fixes\": \"SEO: Add link to related resource in paragraph 4. Authenticity: No fixes needed - voice is natural. Readability: Split longest FAQ answer into two shorter paragraphs. Engagement: No fixes needed. Trust: No fixes needed. Conversion: No fixes needed.\",\n  \"impact\": \"SEO: Minor boost to internal link equity. Authenticity: Maintains low AI detection risk. Readability: Marginal mobile engagement improvement. Engagement: Strong improvement from initial version. Trust: Significant EEAT improvement achieved. Conversion: Good balance maintained.\"\n}\n\n## Instructions:\n- Score each category from 0-100 based on the criteria above\n- Calculate overall score (average of all 6 categories)\n- Compare against initial scores ({{ $('2nd Scoring Agent3').first().json.message.content.overallScore }}) in your evaluation\n- Note whether improvements were successful or if new issues emerged\n- Be specific and actionable in remaining issues/fixes/impact\n- Consolidate all findings into single strings (comma-separated)\n- No fluff, repetition, or vague feedback\n\n## Improved Content to Re-Evaluate:\n{{ $json.data[1].text }}\n\nReturn ONLY valid JSON in the exact format shown above. No additional text or commentary."
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        11280,
        -5104
      ],
      "id": "05b36fc1-dc16-4668-86d6-d56c17551003",
      "name": "Scoring1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "folderId": "={{ $('Create folder1').item.json.id }}",
        "title": "Output 2"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        10480,
        -5232
      ],
      "id": "0868431d-250a-4b80-8c7a-9575f5876711",
      "name": "Create a document6",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=Overall Score: {{ $('Scoring1').item.json.message.content.overallScore }}/100\n\nPotential Issues: {{ $('Scoring1').item.json.message.content.issues }}\n\nPotential Fixes: {{ $('Scoring1').item.json.message.content.fixes }}\n\nPotential Impact: {{ $('Scoring1').item.json.message.content.impact }}\n\nCurrent Content: {{ $('Improvement LLM3').item.json.data[1].text }}\n\n"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        12080,
        -4992
      ],
      "id": "f23eaabc-6174-4c2e-8cfb-1aca10a898a1",
      "name": "Update a document6",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "folderId": "={{ $('Create folder1').item.json.id }}",
        "title": "Output 2"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        9488,
        -5360
      ],
      "id": "4b2fb7ab-8074-45df-83b9-bf3ae81925fa",
      "name": "Create a document16",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=Overall Score: {{ $('1st Scoring Agent3').item.json.message.content.overallScore }}/100\n\nPotential Issues: {{ $('1st Scoring Agent3').item.json.message.content.issues }}\n\nPotential Fixes: {{ $('1st Scoring Agent3').item.json.message.content.fixes }}\n\nPotential Impact: {{ $('1st Scoring Agent3').item.json.message.content.impact }}\n\nCurrent Content: {{ $('Document Export Sanitization5').item.json.message.content }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        9840,
        -5360
      ],
      "id": "ee5595fd-237a-47ef-becd-728f1f86b248",
      "name": "Update a document16",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "claude-sonnet-4-20250514",
          "mode": "list",
          "cachedResultName": "Claude Sonnet 4"
        },
        "options": {
          "maxTokensToSample": 8000,
          "thinking": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
      "typeVersion": 1.3,
      "position": [
        9504,
        -4784
      ],
      "id": "aab37b33-d6aa-4249-bdb8-7db23addb6ef",
      "name": "Anthropic Chat Model21"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert SEO and content strategist who evaluates content quality across key performance areas. You provide honest, actionable feedback with specific scores and improvement recommendations based on strict quality criteria.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# Content Quality Evaluation\n\n## Evaluation Criteria Reference:\n- Target word count: {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words)\n- Target keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n- Client name: {{ $('Webhook1').first().json.body.client_name }}\n\n## Critical Quality Checks:\n- Opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within first two sentences\n- Never replaces {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- No greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery\n- Written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never uses \"we,\" \"our,\" \"us\" from company perspective\n- Uses second person (\"you\") or neutral third person throughout\n- Word count within target range\n- Keywords integrated naturally (not stuffed)\n\n## Task\nScore this content across 6 categories (0-100) and provide specific improvement recommendations.\n\n## Scoring Categories:\n\n### 1. SEO Optimization (0-100)\nEvaluate:\n- Keyword integration (natural placement, density, variations)\n- Meta title and description quality\n- Header structure (H1-H4 hierarchy, keyword usage)\n- Featured snippet readiness\n- Internal linking opportunities\n- Semantic relevance and entity relationships\n\n### 2. Human Authenticity / AI Detection (0-100)\nEvaluate:\n- Conversational, natural tone (sounds like \"friend giving advice\")\n- Avoids AI phrases (\"It's important to note,\" \"Additionally,\" \"In conclusion,\" \"Streamline,\" \"Leverage\")\n- Natural transitions and varied sentence structure\n- Personality and authentic voice\n- No robotic or corporate language\n\n### 3. Readability & Structure (0-100)\nEvaluate:\n- Paragraph length (2-4 sentences ideal)\n- Header clarity and logical flow\n- Scannability (bold terms, lists, formatting)\n- Mobile-friendly structure\n- Clear topic progression\n\n### 4. Engagement & Clarity (0-100)\nEvaluate:\n- Clear, direct answers to reader questions\n- Compelling opening and conclusion\n- Practical, actionable advice\n- Examples and real-world application\n- Maintains reader interest throughout\n\n### 5. Trust & Authority (EEAT) (0-100)\nEvaluate:\n- Credible sources and data cited\n- Professional expertise demonstrated\n- Transparent, honest information\n- Admits limitations where appropriate\n- Authoritative but not arrogant tone\n\n### 6. Conversion/Business Value (0-100)\nEvaluate:\n- Client ({{ $('Webhook1').first().json.body.client_name }}) positioned naturally and effectively\n- Clear value proposition for reader\n- Natural calls-to-action or next steps\n- Builds trust in the client's services\n- Balances helpfulness with business goals\n\n## Scoring Guidelines:\n- 90-100: Exceptional, publication-ready\n- 80-89: Very good, minor tweaks needed\n- 70-79: Good, some improvements recommended\n- 60-69: Acceptable, notable issues to address\n- Below 60: Needs significant revision\n\n## Output Format (JSON only - no additional text):\n\n{\n  \"seoOptimization\": 85,\n  \"humanAuthenticity\": 92,\n  \"readabilityStructure\": 88,\n  \"engagementClarity\": 90,\n  \"trustAuthority\": 87,\n  \"conversionValue\": 89,\n  \"overallScore\": 88.5,\n  \"issues\": \"SEO: Primary keyword could appear earlier in first H2. Authenticity: One instance of 'Additionally' found in paragraph 3. Readability: FAQ section has overly long answers. Engagement: Opening could be more compelling. Trust: Missing citation for statistic in paragraph 5. Conversion: Client name mentioned only twice after introduction.\",\n  \"fixes\": \"SEO: Rewrite first H2 to include primary keyword naturally. Authenticity: Replace 'Additionally' with 'Plus' or 'Also'. Readability: Break FAQ answers into 2-3 sentence responses. Engagement: Start with more provocative question or scenario. Trust: Add source attribution for the 73% statistic. Conversion: Add 2-3 more natural mentions of client throughout article.\",\n  \"impact\": \"SEO: +5-8 ranking positions for primary keyword. Authenticity: Reduces AI detection risk by 15%. Readability: Improves mobile engagement by 20%. Engagement: Could increase average time on page by 25%. Trust: Strengthens EEAT signals and credibility. Conversion: Likely increases consultation requests by 10-15%.\"\n}\n\n\n## Instructions:\n- Score each category from 0-100 based on the criteria above\n- Calculate overall score (average of all 6 categories)\n- Be specific and actionable in issues/fixes/impact\n- Consolidate all findings into single strings (comma-separated)\n- No fluff, repetition, or vague feedback\n- Focus on the most impactful improvements\n\n## Content to Evaluate:\n{{ $json.message.content }}\n\nReturn ONLY valid JSON in the exact format shown above. No additional text or commentary."
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        8848,
        -5152
      ],
      "id": "19526d87-4e49-4289-a88b-580f0adc1d60",
      "name": "1st Scoring Agent3",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "notesInFlow": true,
      "notes": "First scoring agent"
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "={{ $json.id }}",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "text": "=Overall Score: {{ $('2nd Scoring Agent3').item.json.message.content.overallScore }}/100\n\nPotential Issues: {{ $('2nd Scoring Agent3').item.json.message.content.issues }}\n\nPotential Fixes: {{ $('2nd Scoring Agent3').item.json.message.content.fixes }}\n\nPotential Impact: {{ $('2nd Scoring Agent3').item.json.message.content.impact }}\n\nCurrent Content: {{ $('1st Improvement LLM3').item.json.data[1].text }}\n"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        10704,
        -5232
      ],
      "id": "dc7dd039-f881-4d0b-8208-0d5dc5ea7def",
      "name": "Update a document7",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "number": [
            {
              "value1": "={{ $json.message.content.overallScore }}",
              "operation": "largerEqual",
              "value2": 73
            }
          ]
        }
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        11632,
        -5104
      ],
      "id": "093a048a-cbc9-46cb-818c-7157360e389c",
      "name": "80 +?7",
      "notes": "Checks if content score meets the target threshold of 85"
    },
    {
      "parameters": {
        "folderId": "={{ $('Create folder1').first().json.id }}",
        "title": "Output 2"
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        11856,
        -4992
      ],
      "id": "7fe40e17-34d4-4e38-b434-23d5e600e0e8",
      "name": "Create a document7",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "TFGDoCtIHBkFygK6",
          "name": "Google Docs account 2"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a senior SEO editor with expertise in Google's ranking algorithms and featured snippet optimization.\n\nCRITICAL: The final article MUST be {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Technical optimizations must not change the word count.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nTechnical polish must maintain this word count.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nAdd meta elements and ensure perfect technical structure while preserving the conversational, helpful tone and maintaining target word count.\n\n## Required Optimizations:\n\n### Meta Elements (Outside Word Count)\n- **Meta Title**: 50-60 characters, includes primary keyword + {{ $('Webhook1').first().json.body.client_name }}, compelling click-through\n- **Meta Description**: 150-155 characters, includes primary keyword, clear value proposition, natural call-to-action\n\n### Header Structure (Within Article)\n- Ensure clean H1-H4 hierarchy\n- One H1 only (the title)\n- Logical H2s that cover main topics\n- Supporting H3s and H4s where appropriate\n- All headers should be conversational questions or statements, not corporate\n\n### Snippet Formatting\n- Format key sections as snippet-ready blocks (clear definitions, numbered lists for processes, bullet lists for features)\n- Lead paragraphs with direct answers (25-30 words ideal for featured snippets)\n- Bold key terms and answers naturally\n- Use tables where appropriate for comparison content\n\n### Technical Polish\n- Each section directly answers its heading's question\n- Clear topic flow and semantic relationships\n- Proper use of lists, emphasis, and formatting\n- Mobile-friendly paragraph length (2-4 sentences)\n\n### Tone Preservation\n- Maintain the natural \"friend giving advice\" conversational voice throughout\n- Don't let technical structure make content sound robotic\n- Keep contractions, natural transitions, varied sentence length\n- Preserve personality and authenticity\n\n## Article to Optimize:\n{{ $json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Meta title 50-60 characters?\n3. Meta description 150-155 characters?\n4. Only one H1 in the article?\n5. Still sounds like genuine, helpful advice from a knowledgeable friend?\n6. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n7. No \"we/our\" from any company perspective?\n\n## Output Format:\n\nMeta Title: [Your Optimized Title - 50-60 chars]\nMeta Description: [Your Optimized Description - 150-155 chars]\n\n[Full Optimized Article With Proper H1-H4 Structure]\n\nQuality Check: Does this maintain authentic helpfulness while having perfect technical structure?"
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        6512,
        -5920
      ],
      "id": "13f21f53-6aab-4b35-885e-7c2f6c54fd19",
      "name": "Final SEO Snippet Optimization",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are a technical content production assistant specializing in document formatting and export preparation.\n\nCRITICAL: The final sanitized article MUST remain {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). Sanitization is formatting-only and must not change word count.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nSanitization must not alter word count - this is formatting cleanup only.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n(Keywords should already be properly integrated - do not modify content)\n\n# Critical Rules (Already Applied - Verify Only)\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Content written as NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nPrepare this article for clean DOCX export and client delivery through formatting sanitization only.\n\n## Required Sanitization (Formatting Changes Only):\n\n### Character Replacement\n- Replace smart quotes (\"\") with straight ASCII quotes (\"\")\n- Replace smart apostrophes (') with straight apostrophes (')\n- Replace em dashes (—) with double hyphens (--)\n- Replace en dashes (–) with single hyphens (-)\n- Remove any other non-ASCII characters or special symbols\n- Preserve all HTML entities if present\n\n### Spacing & Formatting Cleanup\n- Remove double spaces (replace with single space)\n- Eliminate rogue line breaks within paragraphs\n- Ensure consistent paragraph spacing (one blank line between paragraphs)\n- Remove trailing spaces at end of lines\n- Ensure consistent spacing after punctuation\n\n### Header Formatting\nKeep headers clearly marked using markdown:\n- H1: # Header Text\n- H2: ## Header Text  \n- H3: ### Header Text\n- H4: #### Header Text\n\n### List Formatting\n- Numbered lists: 1. Item text\n- Bullet lists: - Item text\n- Maintain consistent indentation\n\n## What NOT to Change:\n- Do not alter any wording or phrasing\n- Do not modify sentence structure\n- Do not change paragraph order or content\n- Do not add or remove any substantive text\n- Do not modify meta title or meta description\n- This is FORMATTING ONLY\n\n## Article to Sanitize:\n{{ $json.data[1].text }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count still between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. All smart quotes replaced with straight quotes?\n3. All special dashes replaced with ASCII hyphens?\n4. No double spaces or irregular line breaks?\n5. Content unchanged - only formatting cleaned?\n6. {{ $('Webhook1').first().json.body.client_name }} still in first two sentences?\n\n## Output Requirements:\nReturn ONLY the clean, sanitized article ready for Word document import. No explanatory text, meta-commentary, or word count in output.\n\nFormat: Start with Meta Title and Meta Description (if present), then the full article with clean markdown formatting."
            }
          ]
        },
        "options": {
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        8496,
        -5152
      ],
      "id": "9bbe8819-522e-43e9-b829-f5c7d4465aad",
      "name": "Document Export Sanitization5",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "chatgpt-4o-latest",
          "mode": "list",
          "cachedResultName": "CHATGPT-4O-LATEST"
        },
        "messages": {
          "values": [
            {
              "content": "=You are an expert content writer who creates authentic, helpful articles that sound like genuine advice from a knowledgeable consultant. \n\nCRITICAL REQUIREMENT: Every article MUST be {{ $('Webhook1').first().json.body.word_count }} words. Acceptable range: {{ $json.word_count * 0.9 }} to {{ $json.word_count * 1.1 }} words. Count carefully and adjust before finalizing. Do not include the word count in your output.\n\nYour writing is natural and conversational but always professional, never corporate or robotic.\n\n# Global Rules\n1. Always mention the client's name ({{ $('Webhook1').first().json.body.client_name }}) naturally in the opening paragraph, within the first two sentences, unless explicitly instructed otherwise.\n2. Never write from the company's perspective (\"we,\" \"our,\" \"join us\"). Always write in second person (\"you\") or neutral third person, as an outside expert giving advice about {{ $('Webhook1').first().json.body.client_name }}.\n3. Never open with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattering phrases like \"dear readers,\" \"lovers of,\"  etc.\n4. Openings must start with an observation, problem, or question tied to {{ $('Webhook1').first().json.body.client_name }} — not a generic greeting or sales pitch.\n5. Use the following context:\n   - Client: {{ $('Webhook1').first().json.body.client_name }}\n   - Topic: {{ $json.brief_title }}\n   - Instructions: {{ $('Webhook1').first().json.body.creative_brief }}\n   - Current date: {{ $now.toISO() }}\n6. Tone should feel approachable and human — like trusted advice from someone with real experience. Avoid filler, clichés, or anything that feels AI-generated.\n7. Ensure every article begins with a clear, audience-focused hook that establishes why the content matters to the reader.\n\nYour goal: Write content that sounds like it comes from a knowledgeable expert who has lived and worked in the field, while showcasing the client clearly and appropriately from the start.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
              "role": "system"
            },
            {
              "content": "=# ABSOLUTE REQUIREMENT - READ THIS FIRST\nYou MUST write exactly {{ $('Webhook1').first().json.body.word_count }} words (±10% acceptable).\nThis is NON-NEGOTIABLE. Before finishing, verify your word count and adjust.\nIf under range: add examples, expand explanations, include more insights.\nIf over range: tighten without losing substance.\n\nYou MUST hit this word count target. Do not include the word count in your final article output.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force.\n- Prefer the primary/first keyword near the title/first H2 if natural.\n\n# Writing Voice & Style\nWrite like you're having coffee with someone who asked for your honest advice:\n- Use natural speech and contractions\n- Mix short and flowing sentences\n- Add observations, mild controversy, and rhetorical questions\n- Use parenthetical thoughts and casual transitions\n- Always write in second person (\"you\") or neutral third person, never in first person for {{ $('Webhook1').first().json.body.client_name }}\n\n# Content Approach\n- Share insights as if firsthand\n- Include \"what I've noticed\" style observations and real scenarios\n- Use everyday analogies, not jargon\n- Disagree with bad/common advice when better points exist\n- Admit limits when things don't always work\n\n# Critical: NEVER Use These AI Phrases\n\"You're Not Alone\" | \"You Are Not Alone\" | \"It's important to note\" | \"Additionally/Furthermore\" | \"In today's digital landscape\" | \"Streamline/leverage/optimize/enhance\" | \"In conclusion\" | Perfect bullet parallelism\n\n# Use These Natural Transitions Instead\n\"Also,\" \"Plus,\" \"Here's the deal,\" \"The thing is,\" \"So basically,\" \"Oh, and don't forget\"\n\n# Structure Requirements\n- Opening must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Opening must be a natural observation, problem, or question tied to {{ $('Webhook1').first().json.body.client_name }} — never a greeting, fluff, or sales pitch\n- Write in flowing conversational paragraphs, not stiff blog headings\n- Use subheads as casual questions or statements only if needed\n- Include mild frustrations or challenges around misconceptions\n- End with genuine advice, not a corporate wrap-up\n\n# Client Name Requirement\n- Always mention the client name ({{ $('Webhook1').first().json.body.client_name }}) naturally in the opening paragraph, within the first two sentences\n- Refer back to {{ $('Webhook1').first().json.body.client_name }} throughout the piece when contextually relevant (not just once at the start)\n- Never substitute vague phrases like \"this company\" or \"the brand\" when {{ $('Webhook1').first().json.body.client_name }} should be used\n\n# Your Content Assignment\nTitle: {{ $json.brief_title }}\nBrief: {{ $('Webhook1').first().json.body.creative_brief }}\nTarget Audience: {{ $('Webhook1').first().json.body.audience }}\nSEO Keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n\n# Output Requirements\n- Write the complete article within {{ $json.word_count * 0.9 }}-{{ $json.word_count * 1.1 }} words\n- Do NOT include \"Word Count: X\" or any meta-information in your output\n- End with the final sentence of your article, nothing else\n\n# Quality Check\n- Read aloud. If any sentence sounds stiff, corporate, or AI-like, rewrite it.\n- If the introduction starts with a greeting, audience-flattering phrase, or does not mention {{ $('Webhook1').first().json.body.client_name }}, rewrite it before continuing.\n- Do not write in the voice of {{ $('Webhook1').first().json.body.client_name }} (no \"we,\" \"our,\" or \"join us\").\n\n# FINAL VERIFICATION STEP\nBefore submitting:\n1. Count your total words\n2. Target range: {{ $json.word_count * 0.9 }}-{{ $json.word_count * 1.1 }} words\n3. If outside range, revise immediately by expanding thin sections or tightening verbose ones\n4. Submit ONLY when within range"
            }
          ]
        },
        "options": {
          "maxTokens": 4096,
          "temperature": 0.5
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        1808,
        -5792
      ],
      "id": "11448355-0856-4753-b3e5-1e351e90fe08",
      "name": "OpenAI Draft (GPT-4O)1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count (MANDATORY)\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $json.word_count * 0.9 }} to {{ $json.word_count * 1.1 }} words\n\nYou MUST hit this word count target. Do not include the word count in your final article output.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force.\n- Prefer the primary/first keyword near the title/first H2 if natural.\n\n# Global Rules\n1. Always mention the client's name ({{ $('Webhook1').first().json.body.client_name }}) naturally in the opening paragraph, within the first two sentences, unless explicitly instructed otherwise.\n2. Openings must be professional, relevant, and tied directly to the client's industry, audience, or problem space. Do not use jokes, unrelated stories, or casual metaphors unless requested in the brief.\n3. Tone should feel approachable and human — like trusted advice from someone with real experience. Avoid filler, clichés, or anything that feels AI-generated.\n4. Ensure every article begins with a clear, audience-focused hook that establishes why the content matters to the reader.\n5. Never substitute vague phrases like \"this company\" or \"the brand\" when {{ $('Webhook1').first().json.body.client_name }} should be used.\n\n# Writing Voice & Style\nWrite like you're having coffee with someone who asked for your honest advice:\n- Use natural speech: \"I think,\" \"Here's what works,\" \"Honestly,\" \"Look\"\n- Mix short punchy sentences with flowing ones\n- Include personal observations and mild controversy when relevant\n- Add parenthetical thoughts (we all do this) and natural rhetorical questions\n- Use contractions and start sentences with \"And,\" \"But,\" \"So\"\n\n# Content Approach\n- Share insights like you've experienced this firsthand\n- Include \"what I've noticed\" observations and real scenarios\n- Use everyday analogies, not business jargon\n- Disagree with common advice when you have better points\n- Admit limitations and when things don't always work\n\n# Critical: NEVER Use These AI Phrases\n\"You're Not Alone\" | \"You Are Not Alone\" | \"It's important to note\" | \"Additionally/Furthermore\" | \"In today's digital landscape\" | \"Streamline/leverage/optimize/enhance\" | \"In conclusion\" | Perfect bullet parallelism\n\n# Use These Natural Transitions Instead\n\"Also,\" \"Plus,\" \"Here's the deal,\" \"The thing is,\" \"So basically,\" \"Oh, and don't forget\"\n\n# Structure Requirements\n- Hook with natural conversation starter\n- Subheadings as questions or statements (not formal headings)\n- Include mild frustrations about misconceptions\n- End with genuine advice, not corporate wrap-up\n\n# Your Content Assignment\nTitle: {{ $json.brief_title }}\nBrief: {{ $('Webhook1').first().json.body.creative_brief }}\nTarget Audience: {{ $('Webhook1').first().json.body.audience }}\nSEO Keywords: {{ $('Webhook1').first().json.body.primary_keywords }}\n\n# Output Requirements\n- Write the complete article within {{ $json.word_count * 0.9 }}-{{ $json.word_count * 1.1 }} words\n- Do NOT include \"Word Count: X\" or any meta-information in your output\n- End with the final sentence of your article, nothing else\n\nAuthentic helpfulness is the goal, but hitting the word count is mandatory.\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert content writer who creates authentic, helpful articles that sound like genuine advice from a knowledgeable friend. \n\nCRITICAL REQUIREMENT: Every article MUST be {{ $('Webhook1').first().json.body.word_count }} words. Acceptable range: {{ $json.word_count * 0.9 }} to {{ $json.word_count * 1.1 }} words. Count carefully and adjust before finalizing.\n\nYour writing feels natural and conversational, never corporate or AI-generated. You have deep expertise across many topics and share insights like someone who's actually lived and worked in these areas. \n\nCurrent date: {{ $now.toISO() }}"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        1808,
        -5504
      ],
      "id": "66454e2a-c9f0-4c38-8f4b-3828654b542c",
      "name": "Claude Draft (Claude Opus 3)1",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=# PRIMARY CONSTRAINT - Word Count\nTarget: {{ $('Webhook1').first().json.body.word_count }} words\nAcceptable range: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words\n\nWhen combining and polishing both versions, stay within this range.\n\n# SEO Keywords\n{{ $('Webhook1').first().json.body.primary_keywords }}\n- Use each listed keyword at least once if it fits naturally; never stuff or force\n- Prefer the primary/first keyword near the title/first H2 if natural\n\n# Critical Rules\n- The opening paragraph must include {{ $('Webhook1').first().json.body.client_name }} within the first two sentences\n- Never replace {{ $('Webhook1').first().json.body.client_name }} with \"the company\" or \"the brand\"\n- Never start with greetings like \"Hello,\" \"Welcome,\" \"Hey,\" or audience-flattery (\"dear readers,\" \"lovers of...\")\n- Write as a NEUTRAL EXPERT about {{ $('Webhook1').first().json.body.client_name }} - never use \"we,\" \"our,\" \"us\" from any company perspective\n- Always use second person (\"you\") or neutral third person\n\n## Objective\nCombine the best elements from both NLP-optimized versions into one smooth, readable article that maintains the conversational \"friend giving advice\" tone and target word count.\n\n## Simple Goals:\n- Take the strongest passages from each version\n- Smooth any awkward transitions or repetitive sections between versions\n- Improve flow and readability without over-editing\n- **Preserve the natural, helpful voice throughout**\n- Keep all SEO optimizations intact (keywords, entities, structure)\n- Maintain word count by selecting best content, not adding\n\n## What to Combine:\n- Choose the more natural-sounding phrasing when versions differ\n- Keep the clearest explanations and examples\n- Eliminate redundancy between the two versions\n- Maintain the best heading structures\n- Preserve all technical optimizations (entity strength, passage clarity, formatting)\n\n## Critical Requirements:\n- Don't rewrite extensively - just polish and combine thoughtfully\n- Maintain the conversational, authentic tone above all else\n- Keep all keyword integration and entity relationships\n- Preserve technical optimizations from previous stages\n- No corporate or overly polished language\n- Stay within {{ $('Webhook1').first().json.body.word_count }} words ±10%\n\n## Input Versions:\n\n### Claude NLP Version:\n{{ $json.text }}\n\n### OpenAI NLP Version:\n{{ $json.message.content }}\n\n## Before Submitting - MANDATORY CHECKS:\n1. Word count between {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }}?\n2. Still sounds like genuine, helpful advice from a knowledgeable friend?\n3. {{ $('Webhook1').first().json.body.client_name }} mentioned naturally in first two sentences?\n4. No \"we/our\" from any company perspective?\n5. Flow feels natural, not choppy or over-edited?\n6. All SEO optimizations preserved?\n\n## Output Requirements:\nProvide ONLY the final polished article. Start with title, end with conclusion. No explanatory text, editing notes, or word count in output.\n\nQuality check: Does this still sound like genuine, helpful advice from a knowledgeable friend?\n\nIMPORTANT: Page Intent: {{ $('Webhook1').first().json.body.page_intent }}\nEnsure the content tone and structure aligns with this intent (e.g., Informational, Transactional, Lead Gen), but DO NOT let this override the core SEO value and critical takeaways of the content.",
        "messages": {
          "messageValues": [
            {
              "message": "=You are an experienced editor who specializes in light content polish and synthesis.\n\nCRITICAL: The final article MUST be {{ $('Webhook1').first().json.body.word_count }} words (±10%: {{ $('Webhook1').first().json.body.word_count * 0.9 }}-{{ $('Webhook1').first().json.body.word_count * 1.1 }} words). When combining versions, maintain this word count.\n\nYour role is to combine multiple versions of content into one flowing article while preserving the authentic, conversational tone and all technical optimizations already completed."
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        5936,
        -5168
      ],
      "id": "195077a5-0f75-4108-b2a7-a02beadaa52e",
      "name": "Claude Humanised Readability Rewrite",
      "retryOnFail": true,
      "waitBetweenTries": 5000
    },
    {
      "parameters": {
        "dataToSave": {
          "values": [
            {
              "key": "requestId",
              "value": "={{ $json.body.request_id }}"
            },
            {
              "key": "client_name",
              "value": "={{ $json.body.client_name }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.executionData",
      "typeVersion": 1.1,
      "position": [
        1136,
        -5552
      ],
      "id": "667209b6-603d-477d-8a51-a71056595a3d",
      "name": "Execution Data1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        6864,
        -5904
      ],
      "id": "f7896ceb-0569-4260-b662-82c5643a1084",
      "name": "QA Merge Input1"
    },
    {
      "parameters": {
        "jsCode": "const content = $input.item.json.content || $input.item.json.text || \"\"; \n// Access global variables from Webhook directly for reliability inside the loop\nconst clientName = $('Webhook1').first().json.body.client_name || \"Client\";\nconst primaryKeywords = $('Webhook1').first().json.body.primary_keywords || []; \nconst wordCountTarget = $('Webhook1').first().json.body.word_count || 0;\nconst forbiddenPhrases = $('Webhook1').first().json.body.forbiddenPhrases || [];\n\nlet issues = [];\n\n// 1. Word Count Check\nconst wordCount = content.trim().split(/\\s+/).length;\nif (wordCount < 500) { // Example threshold, customized as needed\n    issues.push(`Word count is too low (${wordCount} words). Target is > 500.`);\n}\n\n// 2. Client Name Check (First 2 sentences)\nconst sentences = content.match(/[^.!?]+[.!?]+/g) || [];\nconst firstTwoSentences = sentences.slice(0, 2).join(\" \");\nif (!firstTwoSentences.includes(clientName)) {\n    issues.push(`Client name '${clientName}' not found in the first two sentences.`);\n}\n\n// 3. Primary Keywords Check\nif (Array.isArray(primaryKeywords)) {\n    const missingKeywords = primaryKeywords.filter(kw => !content.toLowerCase().includes(kw.toLowerCase()));\n    if (missingKeywords.length > 0) {\n        issues.push(`Missing primary keywords: ${missingKeywords.join(\", \")}`);\n    }\n}\n\n// 4. Forbidden Phrases Check (e.g. \"We\", \"Our\" if strictly 3rd person)\nconst perspectiveErrors = [\" we \", \" our \", \" us \"]; // Simple check\nconst foundPerspectiveErrors = perspectiveErrors.filter(p => content.toLowerCase().includes(p));\nif (foundPerspectiveErrors.length > 0) {\n    issues.push(\"Content uses first-person perspective ('we', 'us') which is forbidden.\");\n}\n\n\n// Retry Counter and Safety Break\nconst maxRetries = 3;\nconst currentRetry = $input.item.json.qa_retry_count || 0;\n\nif (issues.length > 0) {\n    if (currentRetry >= maxRetries) {\n        // Fail the workflow or handle gracefully\n        throw new Error(\"QA Validation failed after \" + maxRetries + \" attempts. Issues: \" + issues.join(\"; \"));\n    }\n}\n\nreturn {\n    json: {\n        qa_retry_count: currentRetry + 1,\n        passed: issues.length === 0,\n        validation_issues: issues.join(\"; \"),\n        content: content, // Pass specific content forward\n        text: content     // Standardize\n    }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        7152,
        -5984
      ],
      "id": "54d8a2ae-0df8-4f2d-a662-f0636e13c6cf",
      "name": "QA Validator Code1"
    },
    {
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.passed}}",
              "value2": true
            }
          ]
        }
      },
      "name": "QA Check Passed?1",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        7472,
        -5984
      ],
      "id": "bbaf0219-91d0-4bb9-85c1-09d379bffdb9"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4o"
        },
        "messages": {
          "values": [
            {
              "content": "\nYou are an FAQ Schema Generator.\nTask: Generate 3-5 Frequently Asked Questions (FAQs) based on the provided article content.\nRequirements:\n1. Questions must be based on real user intent and primary keywords.\n2. Answers must be concise (40-60 words), authoritative, and directly supported by the text.\n3. Output Format:\n   - First, list the FAQs in a readable Markdown format with an H2 heading: \"## Frequently Asked Questions\".\n   - Second, provide the corresponding valid JSON-LD Schema markup in a ```json``` code block.\n   - The JSON-LD must be for `@type: \"FAQPage\"`.\n\nImportant:\n- Return ONLY the FAQ section + JSON-LD block. \n- Do not repeat the full article.\n- The output of this node will be appended to the article.\n\nInput Content:\n{{ $json.content || $json.text }}\n",
              "role": "system"
            }
          ]
        },
        "options": {}
      },
      "id": "c16d7c11-5378-42cf-8d34-f998ca58e9b9",
      "name": "FAQ Schema Generator1",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        7792,
        -6032
      ]
    },
    {
      "parameters": {
        "model": "gpt-4-turbo",
        "prompt": "=You are an expert Content Editor and QA Specialist.\nYour task is to fix specific validation errors in the provided article without compromising its quality, tone, or SEO value.\n\n# Validation Issues to Fix:\n{{ $json.validation_issues }}\n\n# Critical Constraints:\n1. **Fix ONLY the issues listed.** Do not rewrite the entire article unless necessary.\n2. **Maintain Page Intent:** {{ $('Webhook').first().json.body.page_intent }}\n   - Ensure the content still serves this intent (e.g., Informational, Transactional).\n3. **Preserve Client Identity:**\n   - Client Name: {{ $('Webhook').first().json.body.client_name }}\n   - Must appear naturally in the first two sentences if that was the error.\n4. **Tone Check:** Keep the \"friend giving advice\" conversational voice.\n5. **Word Count:** Attempt to stay near the original length.\n\n# Input Content:\n{{ $json.content || $json.text }}\n\n# Output:\nReturn ONLY the corrected article content.",
        "options": {},
        "requestOptions": {}
      },
      "name": "QA Rewriter Agent1",
      "type": "n8n-nodes-base.openAi",
      "typeVersion": 1,
      "position": [
        7856,
        -5808
      ],
      "id": "5be7e638-b8d5-46de-b7a4-d6feb1f933b9"
    },
    {
      "parameters": {
        "jsCode": "\n    const article = $('QA Check Passed?').first().json.content || $('QA Check Passed?').first().json.text || \"\";\n    const faq = $input.item.json.message.content || \"\";\n    \n    return {\n        json: {\n            // content field for next steps\n            text: article + \"\\n\\n\" + faq,\n            content: article + \"\\n\\n\" + faq\n        }\n    };\n    "
      },
      "name": "Append FAQ to Article1",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        8224,
        -6032
      ],
      "id": "b65dc4e1-5ae6-46f2-ba18-65fa327611f7"
    }
  ],
  "pinData": {
    "Clean1": [
      {
        "json": {
          "brief_title": "Signs of Substance Abuse in Teens",
          "brief_text": "SYSTEM ROLE:\nYou are an expert mental health and behavioral health content writer specializing in adolescent care. You have strong SEO knowledge and write authoritative, empathetic articles for parents and caregivers. Your task is to write a fully optimized, markdown-formatted article that follows the structure, SEO rules, and editorial requirements below exactly for The Ridge RTC.\n\nSEO GUIDELINES\n\nFocus Keyword: “Signs of Substance Abuse in Teens”\n\nUse in the H1 (title)\n\nUse in the first paragraph\n\nUse at least two more times naturally in the body\n\nPrimary Keyword: “Teen Substance Abuse Help”\n\nUse in one H2 heading\n\nUse at least two more times naturally in the body\n\nLong-Tail Keywords:\n\n“Signs of Drug and Alcohol Abuse” — use once organically\n\n“Substance Abuse Behavior” — use once organically\n\nINTERNAL LINKS\n\nInclude all three internal links in the article:\n\nLink to The Ridge’s How We Treat page\n\nLink to The Ridge’s Who We Treat page\n\nLink to The Ridge’s Resources page\n\n❗ Do not place the brand name directly next to or around target keywords.\n\nARTICLE COVERAGE\n\nThe article should educate and support parents by helping them recognize early red flags of substance use in teens and understand how to intervene compassionately and effectively. Maintain a calm, educational, and empathetic tone, written for non-clinical readers. Follow a logical structure that covers the following topics and uses the required keywords and links appropriately:\n\nA clear, compassionate introduction acknowledging how difficult it can be for parents to recognize early warning signs of substance use.\n\nUse the focus keyword in the opening paragraph.\n\nMention that identifying the signs of substance abuse in teens early can prevent crisis situations.\n\nIntroduce The Ridge RTC as a trusted, family-focused treatment provider for adolescents.\n\nA section titled Signs of Substance Abuse in Teens: What Every Parent Should Watch For (use focus keyword in the H2).\n\nExplain that warning signs differ depending on the substance and individual teen.\n\nNote that many red flags appear subtle or mimic typical teenage behavior.\n\nInclude an internal link to The Ridge’s Resources page.\n\nA section on physical and behavioral red flags, detailing:\n\nPhysical symptoms such as red eyes, fatigue, sudden changes in appetite, or weight fluctuation.\n\nBehavioral changes including secrecy, lying, neglecting hygiene, or loss of interest in hobbies.\n\nEmphasize that these patterns may progress quickly if ignored.\n\nA section on emotional and social warning signs, describing:\n\nEmotional red flags like irritability, anxiety, or mood swings.\n\nSocial indicators such as a new peer group, poor academic performance, or isolation.\n\nReinforce that emotional and social shifts are often the earliest and easiest to overlook.\n\nA section naturally integrating the long-tail keyword Signs of Drug and Alcohol Abuse, focusing on how substance use appears in day-to-day life.\n\nClues include missing money, finding paraphernalia, or unusual smells.\n\nMention subtle behavioral differences — wearing long sleeves, avoiding eye contact, or defensiveness.\n\nA section using the long-tail keyword Substance Abuse Behavior organically.\n\nExplain how substance use becomes a cycle of secrecy, shame, and dependence.\n\nDescribe the rationalizations teens often use (“I can stop anytime,” “It’s not a big deal”).\n\nHelp parents understand the emotional psychology behind denial and manipulation.\n\nA section on how to approach a teen about possible substance use, focusing on communication strategies:\n\nStay calm and compassionate.\n\nChoose a private, non-confrontational moment.\n\nAsk open-ended questions and focus on understanding.\n\nSuggest professional involvement if the teen resists.\n\nA section titled Teen Substance Abuse Help: When and How to Intervene (use the primary keyword in the H2).\n\nOutline when to seek help — if signs persist, worsen, or become dangerous.\n\nDescribe evidence-based treatments such as detox, therapy, family support, and residential care.\n\nInclude an internal link to The Ridge’s How We Treat page.\n\nA section on professional treatment and family support, explaining how recovery is most successful when parents stay involved.\n\nHighlight The Ridge RTC’s holistic approach combining family therapy, education, and clinical care.\n\nInclude an internal link to The Ridge’s Who We Treat page.\n\nA FAQs section addressing common parent questions:\n\nWhat’s the first step if I suspect my teen is using drugs or alcohol?\nStay calm, collect information, and schedule a professional evaluation.\n\nAre mood changes always a sign of substance use?\nNot always — but when combined with other red flags, they warrant attention.\n\nHow can schools help identify at-risk teens?\nThrough education, mental health programs, and early intervention screenings.\n\nCan teens fully recover from substance use?\nYes, with comprehensive treatment and family engagement, recovery is absolutely possible.\n\nA conclusion reinforcing the importance of early detection and parental involvement.\n\nRestate that recognizing the signs of substance abuse in teens is the first step toward recovery.\n\nEncourage readers to seek teen substance abuse help early and trust The Ridge RTC for professional, compassionate care.\n\nA Key Takeaways section summarizing major points:\n\nRecognizing the signs of substance abuse in teens enables early action and recovery.\n\nEmotional and social shifts often occur before addiction becomes severe.\n\nSigns of drug and alcohol abuse may include secrecy, defensiveness, or sudden withdrawal.\n\nSubstance abuse behavior often hides behind denial and shame.\n\nThe Ridge RTC provides evidence-based, family-centered teen substance abuse help.\n\nA Cited Sources section referencing authoritative organizations and journals, such as:\n\nNational Institute on Drug Abuse (NIDA): Adolescent Substance Use Trends\n\nCenters for Disease Control and Prevention (CDC): Youth Risk Behavior Survey\n\nAmerican Academy of Pediatrics (AAP): Guidelines on Adolescent Substance Use and Prevention\n\nEDITORIAL & FORMATTING RULES\n\nOpening Paragraph: Empathetic and factual. Use the focus keyword once.\n\nTone & Voice: Compassionate, authoritative, and educational — written for parents without clinical jargon.\n\nFormatting:\n\nUse markdown for H1, H2, and H3 headings.\n\nUse bullet points and short paragraphs for readability.\n\nBrand Mentions:\n\nMention The Ridge RTC briefly in the introduction.\n\nMention again in the conclusion as the trusted treatment provider.\n\nKeyword Placement: Follow SEO usage and frequency rules exactly while keeping a natural flow.\n\nInternal Links: Place contextually in the relevant sections noted above.\n\nCitations: Use credible, evidence-based sources in the “Cited Sources” section.",
          "seo_keywords": "Signs of Substance Abuse in Teens, Teen Substance Abuse Help, Signs of Drug and Alcohol Abuse, Substance Abuse Behavior",
          "target_audience": "Parents and Caregivers",
          "articleType": "Blogs",
          "folderID": "1c0EL62x90mZ7d4rVPpK5fwgNfAJWz551",
          "client_name": "The Ridge RTC",
          "wordCount": "1200"
        }
      }
    ],
    "Create folder1": [
      {
        "json": {
          "kind": "drive#file",
          "id": "1c0EL62x90mZ7d4rVPpK5fwgNfAJWz551",
          "name": "The Ridge RTC",
          "mimeType": "application/vnd.google-apps.folder"
        }
      }
    ]
  },
  "connections": {
    "QA Validator Code": {
      "main": [
        [
          {
            "node": "QA Check Passed?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Check Passed?": {
      "main": [
        [
          {
            "node": "FAQ Schema Generator",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "QA Rewriter Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Rewriter Agent": {
      "main": [
        [
          {
            "node": "QA Merge Input",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "FAQ Schema Generator": {
      "main": [
        [
          {
            "node": "Append FAQ to Article",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append FAQ to Article": {
      "main": [
        [
          {
            "node": "Document Export Sanitization5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Merge Input": {
      "main": [
        [
          {
            "node": "QA Validator Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Clean1": {
      "main": [
        [
          {
            "node": "OpenAI Draft (GPT-4O)1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Claude Draft (Claude Opus 3)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Execution Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create folder1": {
      "main": [
        [
          {
            "node": "Clean1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google Drive Notification1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "Claude Draft (Claude Opus 3)1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Data Check & Research Gaps1": {
      "main": [
        [
          {
            "node": "OpenAI Keyword Check + Semantic Gap1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Claude Keyword Check + Semantic Gap1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge3": {
      "main": [
        [
          {
            "node": "Data Check & Research Gaps1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Keyword Check + Semantic Gap1": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude Keyword Check + Semantic Gap1": {
      "main": [
        [
          {
            "node": "Merge5",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Anthropic Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "Claude Keyword Check + Semantic Gap1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Merge5": {
      "main": [
        [
          {
            "node": "Wait18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude Apply Recommendations1": {
      "main": [
        [
          {
            "node": "OpenAI EEAT Injection1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Claude EEAT Injection1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "Claude Apply Recommendations1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI EEAT Injection1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude EEAT Injection1": {
      "main": [
        [
          {
            "node": "Merge6",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge6": {
      "main": [
        [
          {
            "node": "Wait14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model7": {
      "ai_languageModel": [
        [
          {
            "node": "Claude EEAT Injection1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI SEO Optimization1": {
      "main": [
        [
          {
            "node": "Claude NLP & PR Optimization",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI NLP & PR Optimization": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude NLP & PR Optimization": {
      "main": [
        [
          {
            "node": "Merge7",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Anthropic Chat Model11": {
      "ai_languageModel": [
        [
          {
            "node": "Claude NLP & PR Optimization",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Merge7": {
      "main": [
        [
          {
            "node": "Wait6",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model12": {
      "ai_languageModel": [
        [
          {
            "node": "Claude Humanised Readability Rewrite",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model13": {
      "ai_languageModel": [
        [
          {
            "node": "Claude Final SEO Snippet Optimization",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Claude Final SEO Snippet Optimization": {
      "main": [
        [
          {
            "node": "QA Merge Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Humanised Readability Rewrite": {
      "main": [
        [
          {
            "node": "Wait8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Document Export Sanitization": {
      "main": [
        [
          {
            "node": "1st Scoring Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait6": {
      "main": [
        [
          {
            "node": "OpenAI Humanised Readability Rewrite",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait7": {
      "main": [
        [
          {
            "node": "Claude Humanised Readability Rewrite",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait8": {
      "main": [
        [
          {
            "node": "Final SEO Snippet Optimization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait9": {
      "main": [
        [
          {
            "node": "Document Export Sanitization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait10": {
      "main": [
        [
          {
            "node": "Claude Final SEO Snippet Optimization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait11": {
      "main": [
        [
          {
            "node": "Document Export Sanitization5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait14": {
      "main": [
        [
          {
            "node": "OpenAI SEO Optimization1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait17": {
      "main": [
        [
          {
            "node": "OpenAI NLP & PR Optimization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait18": {
      "main": [
        [
          {
            "node": "Claude Apply Recommendations1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1st Improvement LLM2": {
      "main": [
        [
          {
            "node": "2nd Scoring Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2nd Scoring Agent2": {
      "main": [
        [
          {
            "node": "80 +?4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "80+ ?2": {
      "main": [
        [
          {
            "node": "Create a document15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1st Improvement LLM2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "80 +?4": {
      "main": [
        [
          {
            "node": "Create a document4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Max Iterations2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Max Iterations2": {
      "main": [
        [
          {
            "node": "Create a document5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Improvement LLM2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Max Iterations2": {
      "main": [
        [
          {
            "node": "Check Max Iterations2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Improvement LLM2": {
      "main": [
        [
          {
            "node": "Scoring7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model18": {
      "ai_languageModel": [
        [
          {
            "node": "Improvement LLM2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Scoring7": {
      "main": [
        [
          {
            "node": "80 +?5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document4": {
      "main": [
        [
          {
            "node": "Update a document5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document15": {
      "main": [
        [
          {
            "node": "Update a document15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model19": {
      "ai_languageModel": [
        [
          {
            "node": "1st Improvement LLM2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "1st Scoring Agent2": {
      "main": [
        [
          {
            "node": "80+ ?2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "80 +?5": {
      "main": [
        [
          {
            "node": "Create a document5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Max Iterations2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document5": {
      "main": [
        [
          {
            "node": "Update a document4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1st Improvement LLM3": {
      "main": [
        [
          {
            "node": "2nd Scoring Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "2nd Scoring Agent3": {
      "main": [
        [
          {
            "node": "80 +?6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "80+ ?3": {
      "main": [
        [
          {
            "node": "Create a document16",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1st Improvement LLM3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "80 +?6": {
      "main": [
        [
          {
            "node": "Create a document6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Max Iterations3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Max Iterations3": {
      "main": [
        [
          {
            "node": "Create a document7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Improvement LLM3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Max Iterations3": {
      "main": [
        [
          {
            "node": "Check Max Iterations3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Improvement LLM3": {
      "main": [
        [
          {
            "node": "Scoring1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model20": {
      "ai_languageModel": [
        [
          {
            "node": "Improvement LLM3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Scoring1": {
      "main": [
        [
          {
            "node": "80 +?7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document6": {
      "main": [
        [
          {
            "node": "Update a document7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document16": {
      "main": [
        [
          {
            "node": "Update a document16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Chat Model21": {
      "ai_languageModel": [
        [
          {
            "node": "1st Improvement LLM3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "1st Scoring Agent3": {
      "main": [
        [
          {
            "node": "80+ ?3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "80 +?7": {
      "main": [
        [
          {
            "node": "Create a document7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Max Iterations3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create a document7": {
      "main": [
        [
          {
            "node": "Update a document6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Final SEO Snippet Optimization": {
      "main": [
        [
          {
            "node": "QA Merge Input1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Document Export Sanitization5": {
      "main": [
        [
          {
            "node": "1st Scoring Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Draft (GPT-4O)1": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Claude Draft (Claude Opus 3)1": {
      "main": [
        [
          {
            "node": "Merge3",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Claude Humanised Readability Rewrite": {
      "main": [
        [
          {
            "node": "Wait10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execution Data1": {
      "main": [
        [
          {
            "node": "Create folder1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Merge Input1": {
      "main": [
        [
          {
            "node": "QA Validator Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Validator Code1": {
      "main": [
        [
          {
            "node": "QA Check Passed?1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Check Passed?1": {
      "main": [
        [
          {
            "node": "FAQ Schema Generator1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "QA Rewriter Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "QA Rewriter Agent1": {
      "main": [
        [
          {
            "node": "QA Merge Input1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "FAQ Schema Generator1": {
      "main": [
        [
          {
            "node": "Append FAQ to Article1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Append FAQ to Article1": {
      "main": [
        [
          {
            "node": "Document Export Sanitization",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "f3ac8d71-e878-4ef4-a2b6-57b53ecd515f",
  "meta": {
    "instanceId": "a09af904c89d8bd1ffb34a0a4a29385c214bff1ce25df6d68c440d7ac472b65f"
  },
  "id": "t3LNiuZIghvobde3",
  "tags": [
    {
      "createdAt": "2025-07-03T19:19:08.912Z",
      "updatedAt": "2025-07-03T19:19:08.912Z",
      "id": "MVboqPl4w8lxSrR1",
      "name": "SEOBrand"
    }
  ]
}